---
title: "Squirrel activity: Exploration" ## name of your project and analysis step
description: |
    The aim of this study is...
author:
    ## author information; single arguemnts can be deleted if not needed
    - name: "John Smith"
      url: https://izw-berlin.de/en/john-smith-en.html  
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0000-0000-0000
    - name: "Jane Doe"
      url: https://janedoe.com
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
    ## add more authors with the same intendation and styling if needed 
    ## a new author always starts with a hyphen!
date: "`r Sys.Date()`"
output: 
    distill::distill_article:
        highlight: kate      ## styling of code
        code_folding: false  ## if `true` you can expand and shrink code chunks
        toc: true            ## if `true` adds a table of content
        toc_depth: 2         ## level to be displayed in the table of content
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, 
                      dev = "ragg_png", fig.width = 9, fig.height = 6, dpi = 600, retina = 1)
Sys.setlocale("LC_TIME", "C")
```

* **Research question:**
* **Study area:**
* **Data:** 


# Setup

```{r packages}
# install the package librarian, it loads and installs (if necessary) the specified packages from CRAN, GitHub or Bioconductor

#devtools::install_github("DesiQuintans/librarian")
librarian::shelf(#camtrapR,
                 colorspace, 
                 corrplot,
                 #dplyr,
                 EcoDynIZW / d6berlin,
                 #evaluate, 
                 gdata, 
                 #ggplot2, 
                 ggdist, 
                 ggpubr, 
                 here, 
                 #janitor, 
                 #lubridate, 
                 #maptools, 
                 #ropenscilabs / ochRe,
                 osmdata,
                 # "optimbase", maybe needed but has to be installed from the CRAN archive https://cran.r-project.org/web/packages/optimbase/index.html
                 #plyr,
                 raster,
                 #readxl, 
                 #rgdal, 
                 #rgeos, 
                 #rjags, 
                 #rlecuyer, 
                 scico,
                 sf, 
                 #showtext, 
                 skimr, 
                 #snowfall, 
                 #sp, 
                 #stringr, 
                 tidyverse, 
                 #vroom
                 )
```


# Data

```{r data}
#loading the environmental variables and using only the user IDs that are within the cov table
env_var <- readRDS(here::here("output", 
                              "data-proc", 
                              "all_seasons",
                              "ct_focal_covariates_100_20230126.RDS"))
                              #"stacked_raster_values_and_garden_CT_all_seasons_no_nas_proc_20230124.RDS"))

#already formatted and filtered data 
# CT_act_date_proc <- readRDS(here::here("output", "data-proc", "all_seasons",
#                                        "CT_act_date_proc_20230124.RDS"))
CT_species_interest <- readRDS(here::here("output", 
                                          "data-proc", 
                                          "all_seasons",
                                          "CT_species_interest_time_20230124.RDS"))
```

Build a combined table of CT data and evironmental data

```{r}
CT_species_interest <- CT_species_interest %>%
  left_join(y = env_var[, c(1, 5:20)], by = "Station") %>%
  droplevels()
```

Build a table only for squirrels
```{r}
CT_squirrels <- CT_species_interest %>%
  filter(Species == "Squirrel") %>%
  droplevels()

# and with a time difference of at least 30 minutes between squirrel pictures at the same station
CT_squirrels_30min <- CT_squirrels %>%
  filter(diff_samespecies > 30)
```

Count the number of pictures per species per station 
```{r}
CT_per_station <- CT_species_interest %>% 
  dplyr::count(Species, project_phase, Station) %>%
  left_join(y = env_var[, c(1, 3:20)], by = "Station") 

# Overview
head(CT_per_station)
sum(CT_per_station$n) # 30090 = same as number of rows in CT_species_interest
summary(CT_per_station$n)
```

Build a table only for squirrel pictures per station
```{r}
CT_squirrels_station <- CT_species_interest %>% 
  dplyr::count(Species, project_phase, Station)  %>% 
  filter(Species == "Squirrel") %>%
  left_join(y = env_var[, c(1, 3:20)], by = "Station") %>%
  droplevels()

CT_squirrels_station_with_zeros <- CT_squirrels_station[,c(1,3,4)] %>%
  right_join(y = env_var, by = "Station") %>%
  replace_na(list(Species = "Squirrel", n = 0))

# Overview
head(CT_squirrels_station)
sum(CT_squirrels_station$n) # 1867 = same as number of rows in CT_squirrels
summary(CT_squirrels_station$n)
```


##Save these data sets
```{r}
# # CT species interest with env data
# saveRDS(object = CT_species_interest,
#         file = here::here("output",
#                           "data-proc",
#                           "all_seasons",
#                           "CT_species_interest_with_env_20230128.RDS"))
# 
# # CT Squirrels
# saveRDS(object = CT_squirrels,
#         file = here::here("output",
#                           "data-proc",
#                           "all_seasons",
#                           "CT_squirrels_20230128.RDS"))
# 
# # CT Squirrels 30 mins
# saveRDS(object = CT_squirrels_30min,
#         file = here::here("output",
#                           "data-proc",
#                           "all_seasons",
#                           "CT_squirrels_30min_20230128.RDS"))
# 
# # CT species of interest per station
# saveRDS(object = CT_per_station,
#         file = here::here("output",
#                           "data-proc",
#                           "all_seasons",
#                           "CT_species_interest_per_station_20230128.RDS"))
# 
# # CT squirrels per station
# saveRDS(object = CT_squirrels_station,
#         file = here::here("output",
#                           "data-proc",
#                           "all_seasons",
#                           "CT_squirrels_per_station_20230128.RDS"))
# 
# # CT squirrels per station with zeros
# saveRDS(object = CT_squirrels_station_with_zeros,
#         file = here::here("output",
#                           "data-proc",
#                           "all_seasons",
#                           "CT_squirrels_per_station_zeros_20230128.RDS"))
```

## Palettes
```{r palette}
# darkdarkblue beige greyblue brown red
pal_5 <- c("#303B4A", "#E4CAA5", "#4D6476", "#837461", "#C83649") # 
pal_3 <- c("#E4CAA5", "#4D6476", "#837461")
pal_2 <- c("#E4CAA5", "#4D6476")
```

# Plots
Then we make some plots to explore the relationship between the number of pictures and the environmental covariates

Some tables for a small overview
```{r}
# Garden size
CT_squirrels %>%
  group_by(dogs_binary) %>%
  summarise_at(vars(garden_size), funs(mean(., na.rm=TRUE)))

CT_squirrels %>%
  group_by(dogs_binary) %>%
  summarise_at(vars(garden_size), funs(range(., na.rm=TRUE)))
```

## Time scale
### Project phase
```{r}
# Project phase and species of interest
ggplot(data = CT_per_station, mapping = aes(x = project_phase, y = n)) + 
  stat_halfeye(mapping = aes(
    color = project_phase, 
    fill = project_phase),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = project_phase, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 510),
    breaks = seq(0, 500, by = 100),
    expand = c(.02, .001)) + 
  labs(x = "Project phase", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5, guide = "none") +
  scale_fill_manual(values = pal_5, guide = "none") + 
  scale_x_discrete(expand = c(0.05, 0.001))


# Project phase and only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = project_phase, y = n)) + 
  stat_halfeye(mapping = aes(
    color = project_phase, 
    fill = project_phase),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = project_phase, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Project phase", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5, guide = "none") +
  scale_fill_manual(values = pal_5, guide = "none") + 
  scale_x_discrete(expand = c(0.05, 0.001))


# Project phase and only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = project_phase, y = n)) + 
  stat_halfeye(mapping = aes(
    color = project_phase, 
    fill = project_phase),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = project_phase, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Project phase", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5, guide = "none") +
  scale_fill_manual(values = pal_5, guide = "none") + 
  scale_x_discrete(expand = c(0.05, 0.001))
```

### Season
```{r}
# Season and only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = Season, y = n)) + 
  stat_halfeye(mapping = aes(
    color = Season, 
    fill = Season),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = Season, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = Season), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Season", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Season and only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = Season, y = n)) + 
  stat_halfeye(mapping = aes(
    color = Season, 
    fill = Season),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = Season, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = Season), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Season", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```


### Lockdown
```{r}
# Season and only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = lockdown, y = n)) + 
  stat_halfeye(mapping = aes(
    color = lockdown, 
    fill = lockdown),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = lockdown, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = lockdown), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Lockdown", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Season and only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = lockdown, y = n)) + 
  stat_halfeye(mapping = aes(
    color = lockdown, 
    fill = lockdown),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = lockdown, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = lockdown), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Lockdown", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

## Garden scale
### Garden type
```{r}
# Garden type and only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_type, y = n)) + 
  stat_halfeye(mapping = aes(
    color = garden_type, 
    fill = garden_type),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = garden_type, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = garden_type), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Garden type", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type and only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = garden_type, y = n)) + 
  stat_halfeye(mapping = aes(
    color = garden_type, 
    fill = garden_type),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = garden_type, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = garden_type), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Garden type", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```


### Garden size
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per garden size", 
       y = "Number of pictures", 
       x = bquote("Garden size in "* m^2)) + 
  scale_x_continuous(
    limits = c(0, 4100),
    breaks = seq(0, 4000, by = 500),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.008, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# Only squirrels wit zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = garden_size, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per garden size", 
       y = "Number of pictures", 
       x = bquote("Garden size in "* m^2)) + 
  scale_x_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 500),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)
```

### Dogs
```{r}
ct_spatial<-
  st_as_sf(x = env_var,
           coords = c("Long","Lat"), # name the columns with the coordinates
           remove=F, # dont remove long lat columns
           crs=32633) %>% # crs of the points
  st_transform(crs = 3035)
```


```{r}
Dog_map <- 
base_map_imp(color_intensity = 0.6, 
             legend_x = 0.9, 
             legend_y = 0.85) + 
  geom_sf(data = ct_spatial, 
          mapping = aes(colour = as.factor(dogs_binary))) + 
  scale_color_manual(values = c( "1" = "red", "0" = "black"), 
                     name = "Dog", labels = c("No", "Yes"))
Dog_map
```


```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = dogs_binary, y = n)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "dogs_binary", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))


# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = dogs_binary, y = n)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "dogs_binary", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))
```

#### Garden type
```{r}
# Only squirrels
# We have no dogs in allotments. Therefore we have only three levels. For aesthetic reasons we plot it in the following way:
CT_squirrels_station %>%
  mutate(dog_gardentype = as.factor(paste(garden_type, dogs_binary, sep = ""))) %>%
ggplot(mapping = aes(x = dog_gardentype, y = n, fill = dog_gardentype)) + 
  stat_halfeye(mapping = aes(
    color = dog_gardentype,
    fill = dog_gardentype),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
   # position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dog_gardentype,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    #position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dog_gardentype),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
   #position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.001, .001)) +
  labs(x = "Garden type",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = c("#E4CAA5", "#E4CAA5", "#4D6476"), guide = "none") +
  scale_fill_manual(values = c("#E4CAA5", "#E4CAA5", "#4D6476"), guide = "none") +
  scale_x_discrete(expand = c(0.1, 0.001))


# Only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = garden_type, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary,
    fill = dogs_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Garden type",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.001, 0.001))
```

#### Garden size
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 4000),
    breaks = seq(0, 4000, by = 1000),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)
 


# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = garden_size, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)
```

#### cats
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_binary, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary,
    fill = dogs_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Cats",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes"))


# Only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = cats_binary, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary,
    fill = dogs_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Cats",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes"))
```

#### Imperviousness
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = imperviousness_2018, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)
```


#### Noise
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = noise_2017, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)
```

#### Population density
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = pop_2019, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)
```

#### Tree cover density
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2019, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = tree_cover_2019, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)
```

#### Distance to border
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 1000),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = distance_to_border, y = n, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 1000),
    expand = c(.02, .001)) + 
  facet_wrap(~dogs_binary)
```

### Cats
```{r}
Cat_map <- 
base_map_imp(color_intensity = 0.6, 
             legend_x = 0.9, 
             legend_y = 0.85) + 
  geom_sf(data = ct_spatial, 
          mapping = aes(colour = as.factor(cats_binary))) + 
  scale_color_manual(values = c( "1" = "red", "0" = "black"), 
                     name = "Cat", labels = c("No", "Yes"))
Cat_map
```


```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_binary, y = n)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "cats_binary", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))


# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = cats_binary, y = n)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "cats_binary", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))
```

#### Garden type
```{r}
# Only squirrels
# We have no dogs in allotments. Therefore we have only three levels. For aesthetic reasons we plot it in the following way:
CT_squirrels_station %>%
  mutate(dog_gardentype = as.factor(paste(garden_type, dogs_binary, sep = ""))) %>%
ggplot(mapping = aes(x = dog_gardentype, y = n, fill = dog_gardentype)) + 
  stat_halfeye(mapping = aes(
    color = dog_gardentype,
    fill = dog_gardentype),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
   # position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dog_gardentype,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    #position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dog_gardentype),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
   #position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.001, .001)) +
  labs(x = "Garden type",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = c("#E4CAA5", "#E4CAA5", "#4D6476"), guide = "none") +
  scale_fill_manual(values = c("#E4CAA5", "#E4CAA5", "#4D6476"), guide = "none") +
  scale_x_discrete(expand = c(0.1, 0.001))
```


```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_type, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Garden type",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.001, 0.001))

# Only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = garden_type, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Garden type",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.001, 0.001))
```

#### Garden size
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 4000),
    breaks = seq(0, 4000, by = 1000),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)
 


# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = garden_size, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)
```

#### dogs
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = dogs_binary, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dogs",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes"))


# Only squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = dogs_binary, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dogs",
       y = "Number of pictures") +
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes"))
```

#### Imperviousness
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = imperviousness_2018, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)
```


#### Noise
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = noise_2017, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)
```

#### Population density
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = pop_2019, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)
```

#### Tree cover density
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2019, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = tree_cover_2019, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)
```

#### Distance to border
```{r}
# only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)

# squirrels with zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = distance_to_border, y = n, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  facet_wrap(~cats_binary)
```


## Urban scale
### Imperviousness
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per imperviousness", 
       y = "Number of pictures", 
       x = "Imperviousness") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# Only squirrels wit zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = imperviousness_2018, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per imperviousness", 
       y = "Number of pictures", 
       x = "Imperviousness") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)
```


### Noise
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per noise", 
       y = "Number of pictures", 
       x = "Noise") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# Only squirrels wit zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = noise_2017, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per noise", 
       y = "Number of pictures", 
       x = "Noise") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)
```

### Population density
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per Population density", 
       y = "Number of pictures", 
       x = "Population density") + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# Only squirrels wit zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = pop_2019, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per Population density", 
       y = "Number of pictures", 
       x = "Population density") + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)
```

### Tree cover density
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2019, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per Tree cover density", 
       y = "Number of pictures", 
       x = "Tree cover density") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# Only squirrels wit zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = tree_cover_2019, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per Tree cover density", 
       y = "Number of pictures", 
       x = "Tree cover density") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)
```


### Distance to border
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per distance to city border", 
       y = "Number of pictures", 
       x = "Distance to city border") + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# Only squirrels wit zeros
ggplot(data = CT_squirrels_station_with_zeros, mapping = aes(x = distance_to_border, y = n)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per distance to city border", 
       y = "Number of pictures", 
       x = "Distance to city border") + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)
```

***

<details><summary>Session Info</summary>

```{r sessionInfo}
## DO NOT REMOVE!
## We store the settings of your computer and the current versions of the
## packages used to allow for reproducibility
Sys.time()
#git2r::repository() ## uncomment if you are using GitHub
sessionInfo()
```

</details>
