---
title: "Squirrel activity: General description" ## name of your project and analysis step
description: |
    The aim of this study is...
author:
    ## author information; single arguemnts can be deleted if not needed
    - name: "John Smith"
      url: https://izw-berlin.de/en/john-smith-en.html  
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0000-0000-0000
    - name: "Jane Doe"
      url: https://janedoe.com
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
    ## add more authors with the same intendation and styling if needed 
    ## a new author always starts with a hyphen!
date: "`r Sys.Date()`"
output: 
    distill::distill_article:
        highlight: kate      ## styling of code
        code_folding: false  ## if `true` you can expand and shrink code chunks
        toc: true            ## if `true` adds a table of content
        toc_depth: 2         ## level to be displayed in the table of content
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, 
                      dev = "ragg_png", fig.width = 9, fig.height = 6, dpi = 600, retina = 1)
Sys.setlocale("LC_TIME", "C")
```

* **Research question:**
* **Study area:**
* **Data:** 


# Setup
## Packages
```{r packages, message=FALSE, warning=FALSE}
# install the package librarian, it loads and installs (if necessary) the specified packages from CRAN, GitHub or Bioconductor

#devtools::install_github("DesiQuintans/librarian")
librarian::shelf(camtrapR,
                 extrafont,
                 #dplyr,
                 #evaluate, 
                 gdata, 
                 #ggplot2, 
                 ggpubr, 
                 here, 
                 #janitor, 
                 lubridate, 
                 #maptools, 
                 ropenscilabs / ochRe,
                 # "optimbase", maybe needed but has to be installed from the CRAN archive https://cran.r-project.org/web/packages/optimbase/index.html
                 plyr,
                 raster,
                 readxl, 
                 #rgdal, 
                 #rgeos, 
                 #rjags, 
                 #rlecuyer, 
                 thomasp85 / scico, 
                 #sf, 
                 showtext, 
                 skimr, 
                 #snowfall, 
                 #sp, 
                 stringr, 
                 tidyverse, 
                 #vroom
                 )
```

## Data
```{r data}
##Camera Traps detection histories
#loading the environmental variables and using only the user IDs that are within the cov table
env_var <- readRDS(here::here("output", "data-proc", "all_seasons",
                                       "ct_focal_covariates_100_20230104.RDS"))

#already formatted and filtered data 
CT_act_date_proc <- readRDS(here::here("output", "data-proc", "all_seasons",
                                       "CT_act_date_proc_20230105.RDS"))
```


# Summaries
## all species
### Number of pictures per project phase
```{r}
CT_act_date_proc %>% 
  dplyr::count(project_phase)

CT_act_date_proc %>% 
  dplyr::count(project_phase) %>%  
  summarise(mean_phase = mean(n))

length(unique(CT_act_date_proc$Species))
```

## Species of interest
```{r}
CT_species_interest <- CT_act_date_proc %>%
  filter(Species == "Squirrel" | 
           Species == "Cat" | 
           Species == "Marten" | 
           Species == "Raccoon" | 
           Species == "Red Fox")
```


### Summary tables
The first table is a summary of all pictures that were taken of the species and the mean, median, min and max per day
The second table shows the number of pictures per species per season (spring vs autumn) with the number of pictures per season and mean, median, min and max per day

```{r}
table(CT_species_interest$Species, CT_species_interest$Season) 

ggplot(data = CT_species_interest, mapping = aes(x = Species)) + 
  geom_bar() + 
  facet_grid(Season ~ .)

# Pictures per Species over all seasons, mean number of pics per day, median per day
CT_per_species <- CT_species_interest %>% 
  dplyr::count(Species, Date) %>%
  group_by(Species) %>% 
  dplyr::summarize(n_overall = sum(n), 
                   mean_day = mean(n), 
                   median_day = median(n), 
                   min_day = min(n), 
                   max_day = max(n))

CT_per_species
# CT_per_species <- CT_species_interest %>% 
#   dplyr::count(Species, Date)

# CT_per_species_season_day <- CT_species_interest %>% 
#   dplyr::count(Species, Season, Date)

CT_per_species_season <- CT_species_interest %>% 
  dplyr::count(Species, Season, Date) %>%
  group_by(Species, Season) %>% 
  dplyr::summarize(n_overall = sum(n), 
                   mean_day = mean(n), 
                   median_day = median(n), 
                   min_day = min(n), 
                   max_day = max(n))

CT_per_species_season
```

Here is a plot that shows the number of pictures per species for all seasons
```{r fig.height=4, fig.width= 5}
# ggdotchart(data = CT_per_species, x = "Species", y = "n_overall", 
#            sorting = "descending", 
#            ylab = "Nr pictures",
#            shape = 19, 
#            dot.size = 5,
#            add = "segments", 
#            add.params = list(color = "darkgray", size = 2), 
#            color = "Species",
#            #palette = "magma",
#            rotate = FALSE, 
#            show.legend = FALSE, 
#            ggtheme = theme_pubr()) + 
#   theme(legend.position = "none", 
#         panel.border = element_rect(colour = "black", fill=NA, size=2), 
#         axis.ticks = element_line(colour = "black", size = 1)) + 
#   labs_pubr() + 
#   scale_colour_ochre(palette="emu_woman_paired")  

ggdotchart(data = CT_per_species, x = "Species", y = "n_overall", 
           sorting = "descending", 
           ylab = "Number of pictures",
           shape = 19,
           size = 5,
           dot.size = 6,
           add = "segments", 
           add.params = list(color = "darkgray", size = 2), 
           color = "Species",
           #palette = "magma",
           #position = position_dodge(width = 0.2, preserve = "single"), 
           rotate = FALSE, 
           show.legend = FALSE, 
           ggtheme = theme_pubr(x.text.angle = 90)) + 
  scale_colour_manual(values = scico(5, palette = "lajolla", begin = 0.35, end = 1)) +
  theme(legend.position = "none", 
        panel.background = element_rect(fill = "#e9e5db"), 
        plot.background = element_rect(fill = "#e9e5db"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2),
        axis.text.x = element_text(angle = 0, vjust = 1, hjust = 0.5), 
        axis.ticks.length = unit(0.1, "cm")) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# ggsave(filename = here::here("plots","02_general_patterns", "pics_per_species.png"),
#        width = 1200*1.25,
#        height = 1200,
#        units = "px",
#        dpi = 300)

```


And this table shows the number of pictures per species per project phase
```{r}
table(CT_species_interest$Species, CT_species_interest$project_phase) 

ggplot(data = CT_species_interest, mapping = aes(x = Species)) + 
  geom_bar() + 
  facet_grid(project_phase ~ .)

CT_per_species_phase <- CT_species_interest %>% 
  dplyr::count(Species, project_phase, Date) %>%
  group_by(Species, project_phase) %>% 
  dplyr::summarize(n_overall = sum(n), 
                   mean_day = mean(n), 
                   median_day = median(n), 
                   min_day = min(n), 
                   max_day = max(n))

CT_per_species_phase
```

Here we calculate the number of pictures per hour of the day that were taken for each species
```{r}
CT_species_interest <-
  CT_species_interest %>%
  mutate(hour_day = hour(Time))

CT_species_interest_hour <- 
  CT_species_interest %>%
  dplyr::count(Species, project_phase, hour_day)
```

```{r}
##################### BOXPLOT
############## SAME for filtered data (30 min) like Julie
#### Squirrels in SPring: maybbe problems with confidence intervals

CT_species_interest %>% 
  dplyr::count(Species, project_phase, Date) %>%
  group_by(Species, project_phase) %>%
  ggplot(mapping = aes(x = as.factor(project_phase), y = n)) + 
  geom_boxplot()

CT_species_interest %>% 
  dplyr::count(Species, Season, Date) %>%
  group_by(Species, Season) %>%
  ggplot(mapping = aes(x = as.factor(Season), y = n)) + 
  geom_boxplot()
```
### Create tables for all species of interest on their own
```{r}
# Combine the table of the wildlife pictures with the table of the environmental covariates
CT_with_garden_var <- CT_act_date_proc %>%
  left_join(y = env_var, by = "Station")

#CT_with_garden_var
#skim(CT_with_garden_var)

## Squirrels
# Create a table only for squirrels
CT_squirrels <- CT_with_garden_var %>% 
  filter(Species == "Squirrel")

#CT_squirrels
#skim(CT_squirrels)

## Create a table with the number of pictures per station
CT_squirrels_station <- CT_act_date_proc %>%
  filter(Species == "Squirrel") %>%
  group_by(Species, Season, project_phase, lockdown, Station) %>%
  dplyr::count(Station, name = "n_pics") %>%
  left_join(y = env_var, by = "Station") %>%
  ungroup()

#CT_squirrels_station
#skim(CT_squirrels_station)
```



## Squirrels
### Number of squirrels per project phase 
```{r}
squirrels_phase <- CT_act_date_proc %>%
  filter(Species == "Squirrel") %>%
  dplyr::count(project_phase)
squirrels_phase



# sum photos of squirrels during all seasons
sum(squirrels_phase$n)
# mean number of photos during all seasons
mean(squirrels_phase$n)
# mean number of photos during autumn
mean(squirrels_phase$n[c(1,3,5)])
# mean number of photos during spring
mean(squirrels_phase$n[c(2,4)])
```


### Activity plots
#### overall
```{r}
# All data
activityRadial(recordTable = CT_act_date_proc, 
               species = "Squirrel", 
               lwd = 3)
# activityRadial(recordTable = CT_act_date_proc, 
#                species = "Squirrel", 
#                lwd = 3, 
#                line.col = "black", rad.col = "grey", 
#                grid.col = "grey", 
#                grid.bg = "white")

activityRadial(recordTable = CT_act_date_proc, species = "Squirrel", lwd = 3, rp.type = "p", poly.col = gray(0.5, alpha = 0.5))


```

```{r}
squirrels_CT <- CT_species_interest_hour %>%
  filter(Species == "Squirrel") 

squirrels_CT2 <- CT_species_interest_hour %>%
  filter(Species == "Squirrel") %>%
  group_by(Species, hour_day) %>%
  dplyr::summarize(n_hour = sum(n))

# add rows for the hours of the day when there was no picture
squirrels_CT2[15:24,] <- list("Squirrel", c(0:4, 19:23), 0)
```


```{r}
squirrel_tmp <- ggplot(data = squirrels_CT2) + 
  geom_col(mapping = aes(hour_day, n_hour, fill = n_hour), colour = "white", width = 1) + 
  coord_polar(start = 25, direction = 1) + 
  scale_fill_scico(palette = "lajolla") + # bilbao, lajolla, vikO, turku, 
  theme_light() + 
  ylab("number of pictures\n") + 
  labs(title = paste0("Daily activity of ", unique(squirrels_CT2$Species), "s"), 
       fill = "pictures \nper hour") + 
  theme(title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 14), 
        axis.title.x = element_blank(),
        axis.text.x = element_text(colour = "grey20", size = 12), 
        axis.text.y = element_text(colour = "grey20", size = 12),
        legend.title = element_text(size = 12, face = "bold"),
        legend.text = element_text(size = 12),
        panel.border = element_blank(),
        panel.grid = element_line(colour = "#8c8c8b"),#8c8c8b, #b3b2b1
        panel.background = element_rect(fill = "white"), # "#ded9ca"
        plot.background = element_rect(fill = "white"), # "#ded9ca"
        legend.background = element_rect(colour = "white", fill = "white")
        )

squirrel_tmp
```

```{r}
#squirrels_CT2$hour_day_fact <- as.factor(squirrels_CT2$hour_day)
activityDensity(recordTable = CT_act_date_proc, species = "Squirrel", add.rug = TRUE)
```


```{r}
squirrels_line_plot <- ggplot(squirrels_CT2) + 
  geom_line(mapping = aes(x = hour_day, y = n_hour), colour = "#AC4645", size =2) + #"#AC4645" "#5D3125" "#191900"
  xlim(0,23) + 
  ylim(0,450) +
  scale_x_discrete(limits = c(0,6,12,18), labels = c("00:00", "06:00", "12:00", "18:00")) + 
  ylab("number of pictures") + 
  xlab("hour of the day") +
  labs(title = paste0("Daily activity of ", unique(squirrels_CT2$Species), "s")) +
  theme_light() + 
  theme(title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 14), 
        axis.text.x = element_text(colour = "grey20", size = 12), 
        axis.text.y = element_text(colour = "grey20", size = 12),
       # panel.border = element_blank(),
        panel.grid = element_line(colour = "#8c8c8b"),#8c8c8b, #b3b2b1
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "white"), #"#ded9ca"
        plot.background = element_rect(fill = "white") # "#ded9ca"
        )
  
squirrels_line_plot
  
```


#### per season
```{r}
CT_data_per_season <- split(x = CT_act_date_proc, f = CT_act_date_proc$Season)
CT_data_autumn <- as.data.frame(CT_data_per_season[[1]])
CT_data_spring <- as.data.frame(CT_data_per_season[[2]])

```

```{r}
activityRadial(recordTable = CT_data_autumn, 
               species = "Squirrel",
               byNumber = FALSE,
               rp.type = "p", 
               poly.col = gray(0.5, alpha = 0.5), 
               lwd = 3, 
               radial.lim = c(0,0.25))
activityRadial(recordTable = CT_data_autumn, 
               species = "Squirrel", 
               byNumber = TRUE,
               rp.type = "p",
               poly.col = gray(0.5, alpha = 0.5), 
               lwd = 3, 
               radial.lim = c(0,400), writePNG = TRUE, plotDirectory = here::here("plots"))
# activityRadial(recordTable = CT_data_per_season[[1]], 
#                species = "Squirrel", 
#                lwd = 3)
activityRadial(recordTable = CT_data_spring, species = "Squirrel", byNumber = FALSE, rp.type = "p", poly.col = gray(0.5, alpha = 0.5), lwd = 3, radial.lim = c(0,0.25))
activityRadial(recordTable = CT_data_spring, species = "Squirrel", byNumber = TRUE, rp.type = "p", poly.col = gray(0.5, alpha = 0.5), lwd = 3, radial.lim = c(0,400), writePNG = TRUE, plotDirectory = here::here("plots"))

################## Same scale for all seasons
################## overlap plots
```

#### Lockdown
```{r}
CT_data_lockdown <- split(x = CT_squirrels, f = CT_squirrels$lockdown)
```

```{r}
# Kleingarten
activityDensity(recordTable = CT_data_lockdown[[1]], 
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.3)) # no lockdown
# Grundstück
activityDensity(recordTable = CT_data_lockdown[[2]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.3)) # lockdown

# Overlap plot
activityOverlap(recordTable = CT_squirrels, speciesA = 0, speciesB = 1, speciesCol = "lockdown")
```


#### per project phase
```{r}
CT_data_per_phase <- split(x = CT_act_date_proc, f = CT_act_date_proc$project_phase)
CT_data_phase1 <- as.data.frame(CT_data_per_phase[[1]])
CT_data_phase2 <- as.data.frame(CT_data_per_phase[[2]])
CT_data_phase3 <- as.data.frame(CT_data_per_phase[[3]])
CT_data_phase4 <- as.data.frame(CT_data_per_phase[[4]])
CT_data_phase5 <- as.data.frame(CT_data_per_phase[[5]])
```

```{r}
activityRadial(recordTable = CT_data_phase1, 
               species = "Squirrel", 
               rp.type = "p", 
               lwd = 3, 
               radial.lim = c(0,0.25))
# activityRadial(recordTable = CT_data_per_season[[1]], 
#                species = "Squirrel", 
#                lwd = 3)
activityRadial(recordTable = CT_data_phase2, species = "Squirrel", rp.type = "p", lwd = 3, radial.lim = c(0,0.25))
activityRadial(recordTable = CT_data_phase3, species = "Squirrel", rp.type = "p", lwd = 3, radial.lim = c(0,0.25))
activityRadial(recordTable = CT_data_phase4, species = "Squirrel", rp.type = "p", lwd = 3, radial.lim = c(0,0.25))
activityRadial(recordTable = CT_data_phase5, species = "Squirrel", rp.type = "p", lwd = 3, radial.lim = c(0,0.25))

################## Same scale for all seasons
################## overlap plots
#activityOverlap(recordTable = CT_data_per_phase, speciesA = CT_data_per_phase[[1]], speciesB = CT_data_per_phase[[2]])
```

```{r}
activityDensity(recordTable = CT_data_phase1, species = "Squirrel", 
               ylim = c(0,0.2))
activityDensity(recordTable = CT_data_phase2, species = "Squirrel", 
               ylim = c(0,0.2))
activityDensity(recordTable = CT_data_phase3, species = "Squirrel", 
               ylim = c(0,0.2))
activityDensity(recordTable = CT_data_phase4, species = "Squirrel", 
               ylim = c(0,0.2))
activityDensity(recordTable = CT_data_phase5, species = "Squirrel", 
               ylim = c(0,0.2))
```


```{r}
# activityRadial(recordTable = CT_act_date_proc, 
#                species = "Squirrel", 
#                lwd = 3)
# activityRadial(recordTable = CT_act_date_proc, 
#                species = "Squirrel", 
#                lwd = 3, 
#                line.col = "black", rad.col = "grey", 
#                grid.col = "grey", 
#                grid.bg = "white")
```



#### per garden type
```{r}
CT_data_garden_type <- split(x = CT_squirrels, f = CT_squirrels$garden_type)
```

```{r}
# Kleingarten
activityRadial(recordTable = CT_data_garden_type[[1]],
               species = "Squirrel",
               lwd = 3, 
               radial.lim = c(0,0.25))
# Grundstück
activityRadial(recordTable = CT_data_garden_type[[2]],
               species = "Squirrel",
               lwd = 3, 
               radial.lim = c(0,0.25))

# Kleingarten
activityDensity(recordTable = CT_data_garden_type[[1]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.15))
# Grundstück
activityDensity(recordTable = CT_data_garden_type[[2]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.15))
```

#### imperviousness
```{r}
CT_with_garden_var <- CT_act_date_proc %>%
  left_join(y = env_var, by = "Station")

CT_squirrels <- CT_with_garden_var %>% 
  filter(Species == "Squirrel")

CT_squirrels$imperv_class <- 
  ifelse(test = CT_squirrels$imperviousness_2018 <20, 
         yes = 1, 
         no = ifelse(test = CT_squirrels$imperviousness_2018 <40, 
                     yes = 2, 
                     no = ifelse(test = CT_squirrels$imperviousness_2018 <60, 
                                 yes = 3, 
                                 no = ifelse(test = CT_squirrels$imperviousness_2018 <80, 
                                             yes = 4, 
                                             no = ifelse(test = CT_squirrels$imperviousness_2018 <101, 
                                                         yes = 5, 
                                                         no = 99)))))

CT_squirrels$tree_cov_class <- 
  ifelse(test = CT_squirrels$tree_cover_100 <20, 
         yes = 1, 
         no = ifelse(test = CT_squirrels$tree_cover_100 <40, 
                     yes = 2, 
                     no = ifelse(test = CT_squirrels$tree_cover_100 <60, 
                                 yes = 3, 
                                 no = ifelse(test = CT_squirrels$tree_cover_100 <80, 
                                             yes = 4, 
                                             no = ifelse(test = CT_squirrels$tree_cover_100 <101, 
                                                         yes = 5, 
                                                         no = 99)))))

CT_squirrels$pop_class <- 
  ifelse(test = CT_squirrels$population_density_2019 <100, 
         yes = 1, 
         no = ifelse(test = CT_squirrels$population_density_2019 <200, 
                     yes = 2, 
                     no = ifelse(test = CT_squirrels$population_density_2019 <300, 
                                 yes = 3, 
                                 no = ifelse(test = CT_squirrels$population_density_2019 <700, 
                                             yes = 4, 
                                             no = 99))))

```


```{r}
CT_data_imperv <- split(x = CT_squirrels, f = CT_squirrels$imperv_class)
```

```{r}
# 1
activityDensity(recordTable = CT_data_imperv[[1]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.3))
# 2
activityDensity(recordTable = CT_data_imperv[[2]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.3))
# 3
activityDensity(recordTable = CT_data_imperv[[3]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.3))
# 4
activityDensity(recordTable = CT_data_imperv[[4]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.3))
# 5
activityDensity(recordTable = CT_data_imperv[[5]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.3))
```
#### tree cover
```{r}
CT_data_tree <- split(x = CT_squirrels, f = CT_squirrels$tree_cov_class)
```

```{r}
# 1
activityDensity(recordTable = CT_data_tree[[1]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
# 2
activityDensity(recordTable = CT_data_tree[[2]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
# 3
activityDensity(recordTable = CT_data_tree[[3]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
# 4
activityDensity(recordTable = CT_data_tree[[4]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
# 5
activityDensity(recordTable = CT_data_tree[[5]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
```


#### population density
```{r}
# CT_squirrels$pop_class <- 
#   ifelse(test = CT_squirrels$pop_100 <100, 
#          yes = 1, 
#          no = ifelse(test = CT_squirrels$pop_100 <200, 
#                      yes = 2, 
#                      no = ifelse(test = CT_squirrels$pop_100 <300, 
#                                  yes = 3, 
#                                  no = ifelse(test = CT_squirrels$pop_100 <700, 
#                                              yes = 4, 
#                                              no = 99))))

CT_data_pop <- split(x = CT_squirrels, f = CT_squirrels$pop_class)
```

```{r}
# 1
activityDensity(recordTable = CT_data_pop[[1]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
# 2
activityDensity(recordTable = CT_data_pop[[2]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
# 3
activityDensity(recordTable = CT_data_pop[[3]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
# 4
activityDensity(recordTable = CT_data_pop[[4]],
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.4))
```

#### dogs
```{r}
CT_data_dogs <- split(x = CT_squirrels, f = CT_squirrels$dogs_binary)
```

```{r}
# 1
activityDensity(recordTable = CT_data_dogs[[1]], # no dog
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.2))
# 2
activityDensity(recordTable = CT_data_dogs[[2]], # dog
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.2))
```


```{r}
table(CT_squirrels$dogs_binary)
table(CT_squirrels$dogs_binary, CT_squirrels$project_phase)
```
Per project phase (we can see this in the overlap plots)
```{r}
# activityDensity(recordTable = CT_data_dogs[[1]], # no dog
#                species = 1, 
#                speciesCol = "project_phase",
#                lwd = 3, 
#                ylim = c(0,0.2))
# # 2
# activityDensity(recordTable = CT_data_dogs[[1]], # no dog
#                species = 2, 
#                speciesCol = "project_phase",
#                lwd = 3, 
#                ylim = c(0,0.2))
# 
# activityDensity(recordTable = CT_data_dogs[[1]], # no dog
#                species = 3, 
#                speciesCol = "project_phase",
#                lwd = 3, 
#                ylim = c(0,0.2))
# 
# activityDensity(recordTable = CT_data_dogs[[1]], # no dog
#                species = 4, 
#                speciesCol = "project_phase",
#                lwd = 3, 
#                ylim = c(0,0.2))
# 
# activityDensity(recordTable = CT_data_dogs[[1]], # no dog
#                species = 5, 
#                speciesCol = "project_phase",
#                lwd = 3, 
#                ylim = c(0,0.2))
```

##### Overlap plots
```{r}
activityOverlap(recordTable = CT_squirrels, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary")
```

```{r}
# dogs vs no dogs per season
CT_data_per_season <- split(x = CT_squirrels, f = CT_squirrels$Season)
CT_data_autumn <- as.data.frame(CT_data_per_season[[1]])
CT_data_spring <- as.data.frame(CT_data_per_season[[2]])

# spring
activityOverlap(recordTable = CT_data_spring, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary", ylim = c(0,0.2))

# Autumn
activityOverlap(recordTable = CT_data_autumn, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary", ylim = c(0,0.2))

```
Per project phase
```{r}
CT_data_per_phase <- split(x = CT_squirrels, f = CT_squirrels$project_phase)
CT_data_phase1 <- as.data.frame(CT_data_per_phase[[1]])
CT_data_phase2 <- as.data.frame(CT_data_per_phase[[2]])
CT_data_phase3 <- as.data.frame(CT_data_per_phase[[3]])
CT_data_phase4 <- as.data.frame(CT_data_per_phase[[4]])
CT_data_phase5 <- as.data.frame(CT_data_per_phase[[5]])
```

```{r}
# Phase 1
activityOverlap(recordTable = CT_data_phase1, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary", ylim = c(0,0.25))

# Phase 2
activityOverlap(recordTable = CT_data_phase2, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary", ylim = c(0,0.25))

# Phase 3
activityOverlap(recordTable = CT_data_phase3, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary", ylim = c(0,0.25))

# Phase 4
activityOverlap(recordTable = CT_data_phase4, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary", ylim = c(0,0.25))

# Phase 5
activityOverlap(recordTable = CT_data_phase5, speciesA = 0, speciesB = 1, speciesCol = "dogs_binary", ylim = c(0,0.25))
```


#### cats
```{r}
CT_data_cats <- split(x = CT_squirrels, f = CT_squirrels$cats_binary)
table(CT_squirrels$cats_binary)
table(CT_squirrels$cats_binary, CT_squirrels$project_phase)
```

```{r}
# 1
activityDensity(recordTable = CT_data_cats[[1]], # no cat
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.2))
# 2
activityDensity(recordTable = CT_data_cats[[2]], # cat
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.2))
```

#### trees of interest
```{r}
CT_data_tree_interest <- split(x = CT_squirrels, f = CT_squirrels$trees_of_interest)
```

```{r}
# 1
activityDensity(recordTable = CT_data_tree[[1]], # no trees of interest
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.2))
# 2
activityDensity(recordTable = CT_data_tree[[2]], # with trees of interest
               species = "Squirrel",
               lwd = 3, 
               ylim = c(0,0.2))
```

### Save data
We save the combined dataset of camera trap detections and the environmental variables
```{r}
# # CT_with_garden_var
# saveRDS(object = CT_with_garden_var,
#         file = here::here("output", "data-proc", "all_seasons", "CT_with_garden_var_20230106.RDS"))
# 
# # CT_squirrels
# saveRDS(object = CT_squirrels,
#         file = here::here("output", "data-proc", "all_seasons", "CT_squirrels_with_garden_var_20230106.RDS"))
# 
# # CT_squirrels_station
# saveRDS(object = CT_squirrels_station,
#         file = here::here("output", "data-proc", "all_seasons", "CT_squirrels_station_with_garden_var_20230106.RDS"))
```


***

<details><summary>Session Info</summary>

```{r sessionInfo}
## DO NOT REMOVE!
## We store the settings of your computer and the current versions of the
## packages used to allow for reproducibility
Sys.time()
#git2r::repository() ## uncomment if you are using GitHub
sessionInfo()
```

</details>
