---
title: "Squirrel activity: General description Overview" ## name of your project and analysis step
description: |
    The aim of this study is...
author:
    ## author information; single arguemnts can be deleted if not needed
    - name: "John Smith"
      url: https://izw-berlin.de/en/john-smith-en.html  
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0000-0000-0000
    - name: "Jane Doe"
      url: https://janedoe.com
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
    ## add more authors with the same intendation and styling if needed 
    ## a new author always starts with a hyphen!
date: "`r Sys.Date()`"
output: 
    distill::distill_article:
        highlight: kate      ## styling of code
        code_folding: false  ## if `true` you can expand and shrink code chunks
        toc: true            ## if `true` adds a table of content
        toc_depth: 2         ## level to be displayed in the table of content
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, 
                      dev = "ragg_png", fig.width = 9, fig.height = 6, dpi = 600, retina = 1)
Sys.setlocale("LC_TIME", "C")
```

* **Research question:**
* **Study area:**
* **Data:** 


# Setup
```{r packages, message=FALSE, warning=FALSE}
# install the package librarian, it loads and installs (if necessary) the specified packages from CRAN, GitHub or Bioconductor

#devtools::install_github("DesiQuintans/librarian")
librarian::shelf(camtrapR,
                 extrafont,
                 #dplyr,
                 #evaluate, 
                 gdata, 
                 #ggplot2, 
                 ggpubr, 
                 here, 
                 #janitor, 
                 lubridate,
                 overlap, 
                 #maptools, 
                 ropenscilabs / ochRe,
                 # "optimbase", maybe needed but has to be installed from the CRAN archive https://cran.r-project.org/web/packages/optimbase/index.html
                 plyr,
                 raster,
                 readxl, 
                 #rgdal, 
                 #rgeos, 
                 #rjags, 
                 #rlecuyer, 
                 thomasp85 / scico, 
                 #sf, 
                 showtext, 
                 skimr, 
                 #snowfall, 
                 #sp, 
                 stringr, 
                 tidyverse, 
                 #vroom
                 )
```

# Data
```{r data}
##Camera Traps detection histories
#loading the environmental variables and using only the user IDs that are within the cov table
# env_var <- readRDS(here::here("output", "data-proc", "all_seasons",
#                                        "ct_focal_covariates_100_20230104.RDS"))
# 
# #already formatted and filtered data 
# CT_act_date_proc <- readRDS(here::here("output", "data-proc", "all_seasons",
#                                        "CT_act_date_proc_20230105.RDS"))
```

```{r}
#loading the environmental variables 
env_var <- readRDS(here::here("output", 
                              "data-proc", 
                              "all_seasons",
                              "ct_focal_covariates_100_20230126.RDS"))

#already formatted and filtered CT data 
CT_species_interest <- readRDS(here::here("output", 
                                          "data-proc", 
                                          "all_seasons",
                                          "CT_species_interest_with_env_20230128.RDS"))
#CT_species_interest <- droplevels(CT_species_interest)


#  CT squirrels
CT_squirrels <- readRDS(here::here("output", 
                                   "data-proc", 
                                   "all_seasons",
                                   "CT_squirrels_20230128.RDS"))
```

## Palettes
```{r palette}
# darkdarkblue beige greyblue red brown 
pal_5 <- c("#303B4A", "#E4CAA5", "#4D6476", "#C83649", "#837461") # 
pal_3 <- c("#E4CAA5", "#4D6476", "#837461")
pal_2 <- c("#E4CAA5", "#4D6476")
```


# Species of interest
## Summary tables
The first table is a summary of all pictures that were taken of the species and the mean, median, min and max per day
The second table shows the number of pictures per species per season (spring vs autumn) with the number of pictures per season and mean, median, min and max per day

```{r}
table(CT_species_interest$Species, CT_species_interest$Season) 

ggplot(data = CT_species_interest, mapping = aes(x = Species)) + 
  geom_bar() + 
  facet_grid(Season ~ .)

# Pictures per Species over all seasons, mean number of pics per day, median per day
CT_per_species <- CT_species_interest %>% 
  dplyr::count(Species, Date) %>%
  group_by(Species) %>% 
  dplyr::summarize(n_overall = sum(n), 
                   mean_day = mean(n), 
                   median_day = median(n), 
                   min_day = min(n), 
                   max_day = max(n))

CT_per_species
# CT_per_species <- CT_species_interest %>% 
#   dplyr::count(Species, Date)

# CT_per_species_season_day <- CT_species_interest %>% 
#   dplyr::count(Species, Season, Date)

CT_per_species_season <- CT_species_interest %>% 
  dplyr::count(Species, Season, Date) %>%
  group_by(Species, Season) %>% 
  dplyr::summarize(n_overall = sum(n), 
                   mean_day = mean(n), 
                   median_day = median(n), 
                   min_day = min(n), 
                   max_day = max(n))

CT_per_species_season
```

Here is a plot that shows the number of pictures per species for all seasons
```{r }
ggdotchart(data = CT_per_species, x = "Species", y = "n_overall", 
           sorting = "descending", 
           ylab = "Number of pictures",
           shape = 19,
           size = 5,
           dot.size = 6,
           add = "segments", 
           add.params = list(color = "darkgray", size = 2), 
           color = "Species",
           #palette = "magma",
           #position = position_dodge(width = 0.2, preserve = "single"), 
           rotate = FALSE, 
           show.legend = FALSE, 
           ggtheme = theme_pubr(x.text.angle = 90)) + 
  scale_y_continuous(
    limits = c(0, 19000),
    breaks = seq(0, 18000, by = 2000),
    expand = c(.001, .001)) + 
  scale_x_discrete(expand = c(0.08, 0.001)) + 
  scale_colour_manual(values = pal_5) +
  theme(legend.position = "none", 
        panel.background = element_rect(fill = "white"), #e9e5db
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2),
        axis.text.x = element_text(angle = 0, vjust = 1, hjust = 0.5), 
        axis.ticks.length = unit(0.1, "cm")) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)

# ggsave(filename = here::here("plots","02_general_patterns", "pics_per_species.png"),
#        width = 1200*1.25,
#        height = 1200,
#        units = "px",
#        dpi = 300)

```


And this table shows the number of pictures per species per project phase
```{r}
table(CT_species_interest$Species, CT_species_interest$project_phase) 

ggplot(data = CT_species_interest, mapping = aes(x = Species)) + 
  geom_bar() + 
  facet_grid(project_phase ~ .)

CT_per_species_phase <- CT_species_interest %>% 
  dplyr::count(Species, project_phase, Date) %>%
  group_by(Species, project_phase) %>% 
  dplyr::summarize(n_overall = sum(n), 
                   mean_day = mean(n), 
                   median_day = median(n), 
                   min_day = min(n), 
                   max_day = max(n))

CT_per_species_phase
```

Here we calculate the number of pictures per hour of the day that were taken for each species
```{r}
CT_species_interest_hour <- CT_species_interest %>%
  mutate(hour_day = hour(Time)) %>%
  dplyr::count(Species, project_phase, hour_day)

CT_species_interest_hour_station <- CT_species_interest %>%
  mutate(hour_day = hour(Time)) %>%
  dplyr::count(Species, project_phase, Station, hour_day)
```

```{r}
##################### BOXPLOT
############## SAME for filtered data (30 min) like Julie
#### Squirrels in SPring: maybbe problems with confidence intervals

# Plot of the number of pictures per species per day per project phase
CT_species_interest %>% 
  dplyr::count(Species, project_phase, Date) %>%
  group_by(Species, project_phase) %>%
  ggplot(mapping = aes(x = as.factor(project_phase), y = n)) + 
  geom_boxplot() + 
  facet_wrap(~Species)

# Plot of the number of pictures per species per day per season
CT_species_interest %>% 
  dplyr::count(Species, Season, Date) %>%
  group_by(Species, Season) %>%
  ggplot(mapping = aes(x = as.factor(Season), y = n)) + 
  geom_boxplot() + 
  facet_wrap(~Species)
```

# Squirrels
## Summaries 
```{r}
squirrels_phase <- CT_species_interest %>%
  filter(Species == "Squirrel") %>%
  dplyr::count(project_phase)
squirrels_phase

# sum photos of squirrels during all seasons
sum(squirrels_phase$n)
# mean number of photos during all seasons
mean(squirrels_phase$n)
# mean number of photos during autumn
mean(squirrels_phase$n[c(1,3,5)])
# mean number of photos during spring
mean(squirrels_phase$n[c(2,4)])
```


## Activity plots
### Data preparation
```{r}
# Calculate the time in fractions and the radiated time for the overlap estimates
CT_squirrels$time_frac <- (hour(CT_squirrels$DateTimeOriginal)*60 + minute(CT_squirrels$DateTimeOriginal))/(24*60)
CT_squirrels$radtime <- CT_squirrels$time_frac * 2 * pi
```

```{r}
# Number of pictures per hour of the day per project phase
squirrels_hour_station <- CT_species_interest_hour_station %>%
  filter(Species == "Squirrel") %>%
  left_join(y = env_var[, c(1, 3:20)], by = "Station")

# # Number of pictures per hour
# squirrels_CT2 <- CT_species_interest_hour %>%
#   filter(Species == "Squirrel") %>%
#   group_by(Species, hour_day) %>%
#   dplyr::summarize(n_hour = sum(n))
# 
# # add rows for the hours of the day when there was no picture
# squirrels_CT2[15:24,] <- list("Squirrel", c(0:4, 19:23), 0)
```

### overall
```{r}
squirrels_hour_station %>%
  group_by(Species, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  ungroup() %>%
  add_row(Species = "Squirrel", hour_day = c(0:4, 19:23), n_hour = 0) %>%
  ggplot() + 
  geom_col(mapping = aes(hour_day, n_hour, fill = n_hour), colour = "white", width = 1) + 
  coord_polar(start = 25, direction = 1) + 
  scale_fill_scico(palette = "lajolla") + # bilbao, lajolla, vikO, turku, 
  theme_light() + 
  ylab("number of pictures\n") + 
  labs(title = paste0("Daily activity of ", unique(squirrels_CT2$Species), "s"), 
       fill = "pictures \nper hour") + 
  theme(title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 14), 
        axis.title.x = element_blank(),
        axis.text.x = element_text(colour = "grey20", size = 12), 
        axis.text.y = element_text(colour = "grey20", size = 12),
        legend.title = element_text(size = 12, face = "bold"),
        legend.text = element_text(size = 12),
        panel.border = element_blank(),
        panel.grid = element_line(colour = "#8c8c8b"),#8c8c8b, #b3b2b1
        panel.background = element_rect(fill = "white"), # "#ded9ca"
        plot.background = element_rect(fill = "white"), # "#ded9ca"
        legend.background = element_rect(colour = "white", fill = "white"))
```


```{r}
squirrels_hour_station %>%
  group_by(Species, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  ungroup() %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0))  %>%
  ggplot() + 
  geom_line(mapping = aes(x = hour_day, y = n_hour), colour = "#C83649", size =2) + #"#AC4645" "#5D3125" "#191900"
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11)
```

```{r}
# Plots with line colour per value
# We have to use linear interpolation
# # Worth it????????? NOT SURE 


# squirrels_CT %>%
#   group_by(Species, hour_day) %>%
#   dplyr::summarize(n_hour = sum(n)) %>%
#   ungroup() %>%
#   add_row(Species = "Squirrel", hour_day = c(0:4, 19:23), n_hour = 0) %>%
#   ggplot() + 
#   geom_line(mapping = aes(x = hour_day, y = n_hour, colour = n_hour), size =2) # colour = "#AC4645", 

# vals <- approx(x = df$x, y = df$y, n = 500)
# df2 <- data.frame(x = vals$x, y = vals$y)

# squirrels_CT %>%
#   group_by(Species, hour_day) %>%
#   dplyr::summarize(n_hour = sum(n)) %>%
#   ungroup() %>%
#   add_row(Species = "Squirrel", hour_day = c(0:4, 19:23), n_hour = 0) #%>%
# approx(x = squirrels_CT$hour_day, y = squirrels_CT$n_hour, n = 100) #%>%
# ggplot() + 
#   geom_line(mapping = aes(x = hour_day, y = n_hour, colour = n_hour), size =2)

# squirrels_CT2 %>%
#   approx(x = hour_day, y = n_hour)
test <- as.tibble(approx(x = squirrels_CT2$hour_day, y = squirrels_CT2$n_hour, n = 1000))

ggplot(data = test, mapping = aes(x = x, y = y, colour = y)) + 
  geom_line(linewidth = 2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    #labels = c("00:00", "06:00", "12:00", "18:00"), 
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_color_scico(palette = "lajolla", begin = 0.2, end = 1)
```


### Season
```{r}
squirrels_hour_station %>%
  group_by(Season, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = Season, fill = Season)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_squirrels_autumn <- CT_squirrels[CT_squirrels$Season == "autumn", ]$radtime
CT_squirrels_spring <- CT_squirrels[CT_squirrels$Season == "spring", ]$radtime
overlapEst(A = CT_squirrels_autumn, B = CT_squirrels_spring, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_squirrels %>%
  group_by(Season) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```


```{r}
# CT_data_per_season <- split(x = CT_act_date_proc, f = CT_act_date_proc$Season)
# CT_data_autumn <- as.data.frame(CT_data_per_season[[1]])
# CT_data_spring <- as.data.frame(CT_data_per_season[[2]])
# 
# 
# 
# activityRadial(recordTable = CT_data_autumn, 
#                species = "Squirrel",
#                byNumber = FALSE,
#                rp.type = "p", 
#                poly.col = gray(0.5, alpha = 0.5), 
#                lwd = 3, 
#                radial.lim = c(0,0.25))
# activityRadial(recordTable = CT_data_autumn, 
#                species = "Squirrel", 
#                byNumber = TRUE,
#                rp.type = "p",
#                poly.col = gray(0.5, alpha = 0.5), 
#                lwd = 3, 
#                radial.lim = c(0,400), writePNG = TRUE, plotDirectory = here::here("plots"))
# # activityRadial(recordTable = CT_data_per_season[[1]], 
# #                species = "Squirrel", 
# #                lwd = 3)
# activityRadial(recordTable = CT_data_spring, species = "Squirrel", byNumber = FALSE, rp.type = "p", poly.col = gray(0.5, alpha = 0.5), lwd = 3, radial.lim = c(0,0.25))
# activityRadial(recordTable = CT_data_spring, species = "Squirrel", byNumber = TRUE, rp.type = "p", poly.col = gray(0.5, alpha = 0.5), lwd = 3, radial.lim = c(0,400), writePNG = TRUE, plotDirectory = here::here("plots"))

################## Same scale for all seasons
################## overlap plots
```

### Lockdown
```{r}
squirrels_hour_station %>%
  group_by(lockdown, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = lockdown, fill = lockdown)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_squirrels_lockd <- CT_squirrels[CT_squirrels$lockdown == 1, ]$radtime
CT_squirrels_no_lockd <- CT_squirrels[CT_squirrels$lockdown == 0, ]$radtime
overlapEst(A = CT_squirrels_lockd, B = CT_squirrels_no_lockd, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_squirrels %>%
  group_by(lockdown) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```


### Project phase
```{r}
squirrels_hour_station %>%
  group_by(project_phase, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = project_phase, fill = project_phase)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_squirrels_1 <- CT_squirrels[CT_squirrels$project_phase == "1", ]$radtime
CT_squirrels_2 <- CT_squirrels[CT_squirrels$project_phase == "2", ]$radtime
CT_squirrels_3 <- CT_squirrels[CT_squirrels$project_phase == "3", ]$radtime
CT_squirrels_4 <- CT_squirrels[CT_squirrels$project_phase == "4", ]$radtime
CT_squirrels_5 <- CT_squirrels[CT_squirrels$project_phase == "5", ]$radtime
overlapEst(A = CT_squirrels_1, B = CT_squirrels_2, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_1, B = CT_squirrels_3, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_1, B = CT_squirrels_4, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_1, B = CT_squirrels_5, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_2, B = CT_squirrels_4, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_squirrels %>%
  group_by(project_phase) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Garden type
```{r}
squirrels_hour_station %>%
  group_by(garden_type, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = garden_type, fill = garden_type)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_squirrels_garden <- CT_squirrels[CT_squirrels$garden_type == "garden", ]$radtime
CT_squirrels_allotm <- CT_squirrels[CT_squirrels$garden_type == "allotment", ]$radtime
overlapEst(A = CT_squirrels_garden, B = CT_squirrels_allotm, kmax = 3, type = "all")
1-overlapEst(A = CT_squirrels_garden, B = CT_squirrels_allotm, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_squirrels %>%
  group_by(garden_type) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Garden size
```{r}
squirrels_hour_station %>%
  mutate(size_class = as.factor(ifelse(test = garden_size < 500, 
                             yes = 1, 
                             no = ifelse(test = garden_size < 1000, 
                                         yes = 2, 
                                         no = ifelse(test = garden_size < 2000, 
                                                     yes = 3, 
                                                     no = ifelse(test = garden_size < 3000, 
                                                                 yes = 4, 
                                                                 no = 5)))))) %>%
  group_by(size_class, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = size_class)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_size_class <- CT_squirrels %>%
  mutate(size_class = as.factor(ifelse(test = garden_size < 500, 
                                       yes = 1, 
                                       no = ifelse(test = garden_size < 1000, 
                                                   yes = 2, 
                                                   no = ifelse(test = garden_size < 2000, 
                                                               yes = 3, 
                                                               no = ifelse(test = garden_size < 3000, 
                                                                           yes = 4, 
                                                                           no = 5)))))) 

CT_squirrels_size1 <- CT_size_class[CT_size_class$size_class == "1", ]$radtime
CT_squirrels_size2 <- CT_size_class[CT_size_class$size_class == "2", ]$radtime
CT_squirrels_size3 <- CT_size_class[CT_size_class$size_class == "3", ]$radtime
CT_squirrels_size4 <- CT_size_class[CT_size_class$size_class == "4", ]$radtime
CT_squirrels_size5 <- CT_size_class[CT_size_class$size_class == "5", ]$radtime
overlapEst(A = CT_squirrels_size1, B = CT_squirrels_size2, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_size1, B = CT_squirrels_size3, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_size1, B = CT_squirrels_size4, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_size1, B = CT_squirrels_size5, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_size2, B = CT_squirrels_size4, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_size_class %>%
  group_by(size_class) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Dogs
```{r}
squirrels_hour_station %>%
  group_by(dogs_binary, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = dogs_binary)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2) 
```

Overlap estimate
```{r}
CT_squirrels_dogs <- CT_squirrels[CT_squirrels$dogs_binary == 1, ]$radtime
CT_squirrels_no_dogs <- CT_squirrels[CT_squirrels$dogs_binary == 0, ]$radtime
overlapEst(A = CT_squirrels_dogs, B = CT_squirrels_no_dogs, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_squirrels %>%
  group_by(dogs_binary) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

#### dogs per season
```{r}
squirrels_hour_station %>%
  group_by(dogs_binary, Season, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = dogs_binary)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2) + 
  facet_wrap(~Season)
```

Overlap estimate
```{r}
CT_squirrels_dogs_autumn <- CT_squirrels[CT_squirrels$dogs_binary == 1 & CT_squirrels$Season == "autumn", ]$radtime
CT_squirrels_no_dogs_autumn <- CT_squirrels[CT_squirrels$dogs_binary == 0 & CT_squirrels$Season == "autumn", ]$radtime

CT_squirrels_dogs_spring <- CT_squirrels[CT_squirrels$dogs_binary == 1 & CT_squirrels$Season == "spring", ]$radtime
CT_squirrels_no_dogs_spring <- CT_squirrels[CT_squirrels$dogs_binary == 0 & CT_squirrels$Season == "spring", ]$radtime

overlapEst(A = CT_squirrels_dogs_autumn, B = CT_squirrels_no_dogs_autumn, kmax = 3, type = "all")
overlapEst(A = CT_squirrels_dogs_spring, B = CT_squirrels_no_dogs_spring, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_squirrels %>%
  group_by(Season, dogs_binary) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Cats
```{r}
squirrels_hour_station %>%
  group_by(cats_binary, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = cats_binary)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2) 
```

Overlap estimate
```{r}
CT_squirrels_cats <- CT_squirrels[CT_squirrels$cats_binary == 1, ]$radtime
CT_squirrels_no_cats <- CT_squirrels[CT_squirrels$cats_binary == 0, ]$radtime
overlapEst(A = CT_squirrels_cats, B = CT_squirrels_no_cats, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_squirrels %>%
  group_by(cats_binary) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Imperviousness
```{r}
# test <-squirrels_hour_station %>%
#   mutate(class = as.factor(ifelse(test = imperviousness_2018 < 20, 
#                              yes = 1, 
#                              no = ifelse(test = imperviousness_2018 < 40, 
#                                          yes = 2, 
#                                          no = ifelse(test = imperviousness_2018 < 60, 
#                                                      yes = 3, 
#                                                      no = ifelse(test = imperviousness_2018 < 80, 
#                                                                  yes = 4, 
#                                                                  no = 5))))))

## Warum NAS????????
summary(CT_squirrels$imperviousness_2018)
```

```{r}
squirrels_hour_station %>%
  mutate(class = as.factor(ifelse(test = imperviousness_2018 < 20, 
                             yes = 1, 
                             no = ifelse(test = imperviousness_2018 < 40, 
                                         yes = 2, 
                                         no = ifelse(test = imperviousness_2018 < 60, 
                                                     yes = 3, 
                                                     no = ifelse(test = imperviousness_2018 < 80, 
                                                                 yes = 4, 
                                                                 no = 5)))))) %>%
  group_by(class, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = class)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_class <- CT_squirrels %>%
  mutate(class = as.factor(ifelse(test = imperviousness_2018 < 20, 
                             yes = 1, 
                             no = ifelse(test = imperviousness_2018 < 40, 
                                         yes = 2, 
                                         no = ifelse(test = imperviousness_2018 < 60, 
                                                     yes = 3, 
                                                     no = ifelse(test = imperviousness_2018 < 80, 
                                                                 yes = 4, 
                                                                 no = 5)))))) 

CT_class1 <- CT_class[CT_class$class == "1", ]$radtime
CT_class2 <- CT_class[CT_class$class == "2", ]$radtime
CT_class3 <- CT_class[CT_class$class == "3", ]$radtime
CT_class4 <- CT_class[CT_class$class == "4", ]$radtime
CT_class5 <- CT_class[CT_class$class == "5", ]$radtime
overlapEst(A = CT_class1, B = CT_class2, kmax = 3, type = "all")

overlapEst(A = CT_class1, B = CT_class3, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class4, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class5, kmax = 3, type = "all")
overlapEst(A = CT_class2, B = CT_class4, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_class %>%
  group_by(class) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```
### Noise
```{r}
summary(CT_squirrels$noise_2017)
```

```{r}
squirrels_hour_station %>%
  mutate(class = as.factor(ifelse(test = noise_2017 < 40, 
                             yes = 1, 
                             no = ifelse(test = noise_2017 < 50, 
                                         yes = 2, 
                                         no = ifelse(test = noise_2017 < 60, 
                                                     yes = 3, 
                                                     no = ifelse(test = noise_2017 < 70, 
                                                                 yes = 4, 
                                                                 no = 5)))))) %>%
  group_by(class, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = class)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_class <- CT_squirrels %>%
  mutate(class = as.factor(ifelse(test = noise_2017 < 40, 
                             yes = 1, 
                             no = ifelse(test = noise_2017 < 50, 
                                         yes = 2, 
                                         no = ifelse(test = noise_2017 < 60, 
                                                     yes = 3, 
                                                     no = ifelse(test = noise_2017 < 70, 
                                                                 yes = 4, 
                                                                 no = 5)))))) 

CT_class1 <- CT_class[CT_class$class == "1", ]$radtime
CT_class2 <- CT_class[CT_class$class == "2", ]$radtime
CT_class3 <- CT_class[CT_class$class == "3", ]$radtime
CT_class4 <- CT_class[CT_class$class == "4", ]$radtime
CT_class5 <- CT_class[CT_class$class == "5", ]$radtime
overlapEst(A = CT_class1, B = CT_class2, kmax = 3, type = "all")

overlapEst(A = CT_class1, B = CT_class3, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class4, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class5, kmax = 3, type = "all")
overlapEst(A = CT_class2, B = CT_class4, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_class %>%
  group_by(class) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Population density
```{r}
summary(CT_squirrels$pop_2019)
```

```{r}
squirrels_hour_station %>%
  mutate(class = as.factor(ifelse(test = pop_2019 < 40, 
                             yes = 1, 
                             no = ifelse(test = pop_2019 < 70, 
                                         yes = 2, 
                                         no = ifelse(test = pop_2019 < 200, 
                                                     yes = 3, 
                                                     no = ifelse(test = pop_2019 < 400, 
                                                                 yes = 4, 
                                                                 no = 5)))))) %>%
  group_by(class, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = class)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_class <- CT_squirrels %>%
  mutate(class = as.factor(ifelse(test = pop_2019 < 40, 
                             yes = 1, 
                             no = ifelse(test = pop_2019 < 70, 
                                         yes = 2, 
                                         no = ifelse(test = pop_2019 < 200, 
                                                     yes = 3, 
                                                     no = ifelse(test = pop_2019 < 400, 
                                                                 yes = 4, 
                                                                 no = 5)))))) 

CT_class1 <- CT_class[CT_class$class == "1", ]$radtime
CT_class2 <- CT_class[CT_class$class == "2", ]$radtime
CT_class3 <- CT_class[CT_class$class == "3", ]$radtime
CT_class4 <- CT_class[CT_class$class == "4", ]$radtime
CT_class5 <- CT_class[CT_class$class == "5", ]$radtime
overlapEst(A = CT_class1, B = CT_class2, kmax = 3, type = "all")

overlapEst(A = CT_class1, B = CT_class3, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class4, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class5, kmax = 3, type = "all")
overlapEst(A = CT_class2, B = CT_class4, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_class %>%
  group_by(class) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Tree cover density
```{r}
summary(CT_squirrels$tree_cover_2019)
```

```{r}
squirrels_hour_station %>%
  mutate(class = as.factor(ifelse(test = tree_cover_2019 < 10, 
                             yes = 1, 
                             no = ifelse(test = tree_cover_2019 < 30, 
                                         yes = 2, 
                                         no = ifelse(test = tree_cover_2019 < 50, 
                                                     yes = 3, 
                                                     no = ifelse(test = tree_cover_2019 < 70, 
                                                                 yes = 4, 
                                                                 no = 5)))))) %>%
  group_by(class, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = class)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_class <- CT_squirrels %>%
  mutate(class = as.factor(ifelse(test = tree_cover_2019 < 10, 
                             yes = 1, 
                             no = ifelse(test = tree_cover_2019 < 30, 
                                         yes = 2, 
                                         no = ifelse(test = tree_cover_2019 < 50, 
                                                     yes = 3, 
                                                     no = ifelse(test = tree_cover_2019 < 70, 
                                                                 yes = 4, 
                                                                 no = 5)))))) 

CT_class1 <- CT_class[CT_class$class == "1", ]$radtime
CT_class2 <- CT_class[CT_class$class == "2", ]$radtime
CT_class3 <- CT_class[CT_class$class == "3", ]$radtime
CT_class4 <- CT_class[CT_class$class == "4", ]$radtime
CT_class5 <- CT_class[CT_class$class == "5", ]$radtime
overlapEst(A = CT_class1, B = CT_class2, kmax = 3, type = "all")

overlapEst(A = CT_class1, B = CT_class3, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class4, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class5, kmax = 3, type = "all")
overlapEst(A = CT_class2, B = CT_class4, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_class %>%
  group_by(class) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```

### Distance to border
```{r}
summary(CT_squirrels$distance_to_border)
```

```{r}
squirrels_hour_station %>%
  mutate(class = as.factor(ifelse(test = distance_to_border < 1500, 
                             yes = 1, 
                             no = ifelse(test = distance_to_border < 3500, 
                                         yes = 2, 
                                         no = ifelse(test = distance_to_border < 5500, 
                                                     yes = 3, 
                                                     no = ifelse(test = distance_to_border < 7500, 
                                                                 yes = 4, 
                                                                 no = 5)))))) %>%
  group_by(class, hour_day) %>%
  dplyr::summarize(n_hour = sum(n)) %>%
  complete(hour_day = c(0:23), fill = list(n_hour = 0)) %>%
  ungroup() %>%
  ggplot(mapping = aes(x = hour_day, y = n_hour, colour = class)) + 
  geom_line(size =2) + 
  scale_x_continuous(
    limits = c(0,23), 
    breaks = seq(0, 21, by = 3),
    expand = c(.001, .001)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.01, .001)) +
  labs(x = "Hour of the day", 
       y = "Number of pictures") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        #legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, size=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5) #+ 
  #geom_vline(xintercept = c(6,6.5,7))
```

Overlap estimate
```{r}
CT_class <- CT_squirrels %>%
  mutate(class = as.factor(ifelse(test = distance_to_border < 1500, 
                             yes = 1, 
                             no = ifelse(test = distance_to_border < 3500, 
                                         yes = 2, 
                                         no = ifelse(test = distance_to_border < 5500, 
                                                     yes = 3, 
                                                     no = ifelse(test = distance_to_border < 7500, 
                                                                 yes = 4, 
                                                                 no = 5)))))) 

CT_class1 <- CT_class[CT_class$class == "1", ]$radtime
CT_class2 <- CT_class[CT_class$class == "2", ]$radtime
CT_class3 <- CT_class[CT_class$class == "3", ]$radtime
CT_class4 <- CT_class[CT_class$class == "4", ]$radtime
CT_class5 <- CT_class[CT_class$class == "5", ]$radtime
overlapEst(A = CT_class1, B = CT_class2, kmax = 3, type = "all")

overlapEst(A = CT_class1, B = CT_class3, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class4, kmax = 3, type = "all")
overlapEst(A = CT_class1, B = CT_class5, kmax = 3, type = "all")
overlapEst(A = CT_class2, B = CT_class4, kmax = 3, type = "all")
```

Mean activity time
```{r}
CT_class %>%
  group_by(class) %>%
  dplyr::summarise(mean_act_time = hms::hms(seconds_to_period(mean(Time))))
```



***

<details><summary>Session Info</summary>

```{r sessionInfo}
## DO NOT REMOVE!
## We store the settings of your computer and the current versions of the
## packages used to allow for reproducibility
Sys.time()
#git2r::repository() ## uncomment if you are using GitHub
sessionInfo()
```

</details>
