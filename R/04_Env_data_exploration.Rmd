---
title: "Squirrel activity: Exploration of the environmental data" ## name of your project and analysis step
description: |
    The aim of the study is to investigate the influence of altered environmental urban parameters and direct human disturbance expressed by the lockdown together with animal predator risk parameters on the general activity of squirrels
author:
    - name: "Sinah Drenske"
      affiliation: Leibniz Institute for Zoo and Wildlife Research, Technical University Berlin
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0002-2247-6507
    - name: "Julie Louvrier"
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0003-1252-1746
    - name: "Marius Grabow"
      affiliation: Leibniz Institute for Zoo and Wildlife Research, Technical University Berlin
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0003-0702-9642
    - name: "Conny Landgraf"
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      #orcid_id: 0000-0000-0000-0000
    - name: "Stephanie Kramer-Schadt"
      affiliation: Leibniz Institute for Zoo and Wildlife Research, Technical University Berlin
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0002-9269-4446
    - name: "Aimara Planillo"
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0001-6763-9923
date: "`r Sys.Date()`"
output: 
    distill::distill_article:
        highlight: kate      ## styling of code
        code_folding: TRUE  ## if `true` you can expand and shrink code chunks
        toc: true            ## if `true` adds a table of content
        toc_depth: 3         ## level to be displayed in the table of content
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, 
                      dev = "ragg_png", fig.width = 5, fig.height = 4, dpi = 600, retina = 1)
Sys.setlocale("LC_TIME", "C")
```

* **Research question:** Which risk effects increase or decrease the overall activity of red squirrels in urban gardens?  
* **Study area:** Berlin 2019-2020 
* **Data:** Detection histories of squirrels, martens and cats from 4 seasons (spring 2019, autumn 2019, spring 2020, autumn 2020), already filtered as in Louvrier et al. 2021 + environmental information on camera stations.

# Setup

```{r packages}
#remotes::install_github("EcoDynIZW/d6")
d6::simple_load(c("EcoDynIZW/d6berlin",
                  "colorspace",
                  "cowplot",
                  "extrafont", 
                  "ggdist", 
                  "ggplot2",
                  "ggspatial", 
                  "grid",
                  "here",
                  "png",
                  "raster", 
                  "rnaturalearth", 
                  "rnaturalearthdata",
                  "scico",
                  "sf", 
                  "skimr", 
                  "terra",
                  "tidyverse",
                  "viridis"
))
```


## Plot setup
Set theme for ggplots
```{r theme}
theme_set(
  theme(
    legend.position = "none",
    panel.grid = element_blank(),
    panel.background = element_rect(fill = "white"),
    panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
    plot.margin = margin(6, 10, 4, 4),
    axis.ticks = element_line(colour = "black", linewidth = 1.5),
    axis.ticks.length = unit(0.2, "cm"),
    title = element_text(family = "Zilla Slab", size = 15), # axis
    axis.text = element_text(family = "Roboto", size = rel(0.87)))) # axis ticks
```

Palettes

```{r palette}
# darkdarkblue beige greyblue brown red
pal_4 <- c("#303B4A", "#E4CAA5", "#4D6476", "#837461") # , "#C83649"
pal_3 <- c("#E4CAA5", "#4D6476", "#837461")
pal_2 <- c("#E4CAA5", "#4D6476")

# Maps
col_points2 <- c("#000004FF", "#641A80FF", "#277F8EFF", "#4AC16DFF")
pal_alpha <- c("1" = 1, "0" = 0.7)
```

Load fonts

```{r message=FALSE, include=FALSE}
#font_import()
loadfonts(device = "win")
fonts()
```


# Data

```{r data}
#loading the environmental variables and using only the user IDs that are within the cov table
env_var <- readRDS(here::here("output", 
                              "data-proc", 
                              "01_overall_activity",
                              "env_var_binary_species_20230305.RDS"))

## impervious surface
imperv <- rast(here::here("data-raw/geo-raw/imperviousness_berlin_copernicus_raster_10m_2018_3035/imperviousness_berlin_copernicus_raster_10m_2018_3035.tif"))

## water bodies
water <- st_read(here::here("data-raw/geo-raw/waterbodies_Berlin_25833.gpkg")) %>% 
  st_transform(crs = 3035) %>% 
  st_union()

## berlin border
berlin <- st_read(here::here("data-raw/geo-raw/berlin_city_border_25833.gpkg")) %>% 
  st_transform(crs = 3035) %>% 
  st_union()
```

Prepare a class for the size of the points
```{r}
env_var <- env_var %>%
  mutate(squirrel_class = case_when(squirrel_pics < 1 ~ 5, # for 0 pics 
                                    squirrel_pics < 10 ~ 7, # less than 10  
                                    squirrel_pics < 20 ~ 9, # less than 20
                                    squirrel_pics < 30 ~ 11, # less than 30 
                                    squirrel_pics < 40 ~ 13, # less than 40 
                                    squirrel_pics > 39 ~ 15)) # 40 onwards
```

# Map of the camera stations

```{r spatial}
# make it spatial
ct_spatial <- st_as_sf(x = env_var,
           coords = c("Long","Lat"), # name the columns with the coordinates
           remove = F, # dont remove long lat columns
           crs = 32633) %>% # crs of the points
  st_transform(crs = 3035) %>%
  mutate(xcoord = Long, ycoord = Lat)  ## correct the names. Long and Lat should be used only for degrees
```

First plot
```{r spatial}
plot(imperv)
plot(st_geometry(ct_spatial), add = TRUE, col = "blue", pch = 16)
```

aggregate raster for faster plotting
```{r}
#imperv_250 <- aggregate(imperv, fact = 25, fun = mean, na.rm = TRUE)

# get in data frame format
#imperv_df <- as.data.frame(imperv_250, xy = TRUE)
#colnames(imperv_df)[3] <- "imperv"

imperv10_df <- as.data.frame(imperv, xy = TRUE)
colnames(imperv10_df)[3] <- "imperv"
```

Map of Berlin
```{r fig.width = 9, fig.height = 6}
map_berlin2 <-
  ggplot() +
  geom_raster(data = imperv10_df, aes(x = x, y = y, fill = imperv)) +
  scale_fill_viridis(option = "rocket", na.value = NA, direction = -1,
                     #begin = 0.2, 
                     end = 0.9, 
                     alpha = 0.3,
                     name = "Imperviousness") +
  # geom_sf(data = berlin, colour = "#c5c8d9", lwd = 1.2, fill = NA) +
  geom_sf(data = water, fill = "lightblue3", colour = "transparent") +
  geom_sf(data = ct_spatial, aes(colour = project_phase, pch = project_phase, alpha = squirrels_cam_binary),
          size = 2) +
  geom_sf(data = ct_spatial %>%
            filter(squirrels_cam_binary == 1), aes(pch = project_phase),
          size = .5, col = "white") +
  scale_colour_manual(values = rev(col_points2), name = "Phase",
                      labels = c("Spring 19 - no Lockdown", "Autumn 19 - no Lockdown", 
                                 "Spring 20 - Lockdown", "Autumn 20 - Lockdown")) +
  scale_shape_manual(name = "Phase",
                     values = c(16,17,18,15),
                     labels = c("Spring 19 - no Lockdown", "Autumn 19 - no Lockdown", 
                                "Spring 20 - Lockdown", "Autumn 20 - Lockdown")) +
  scale_alpha_manual(values = pal_alpha, name = "Squirrels", labels = c("Yes", "No")) +
  annotation_north_arrow(which_north = "true", location = "bl",
                         pad_x = unit(0.3, "cm"), pad_y = unit(0.7, "cm"),
                         height = unit(1, "cm"),
                         width = unit(0.6, "cm")) +
  annotation_scale(text_cex = 1.5) +
  guides(shape = guide_legend(order = 1),
         colour = guide_legend(order = 1,
                               override.aes = list(colour = rev(col_points2),
                                                   size = c(3,3,4,3)))#,
         #fill = guide_legend(order = 2)#,
         #alpha = "none"
         ) +
  scale_x_continuous(breaks = seq(13.1, 13.7, by = 0.2)) + 
  scale_y_continuous(breaks = seq(52.35, 52.70, by = 0.10)) +
  theme(
    #legend.position = "none",
    #panel.grid = element_blank(),
    #panel.background = element_rect(fill = "white"),
    panel.background = element_rect(fill = NULL, color = "grey80"),
    panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
    plot.margin = margin(6, 10, 4, 4),
    axis.title = element_blank(),
    axis.ticks = element_line(colour = "black", linewidth = 1.5),
    axis.ticks.length = unit(0.2, "cm"),
    title = element_text(family = "Zilla Slab", size = 15), # axis
    axis.text = element_text(family = "Roboto", size = rel(0.87))) # axis ticks

map_berlin2
```

Map of Europe

```{r}
world <- ne_countries(scale = "medium", returnclass = "sf")
europe <- world %>% 
  filter(continent  == "Europe")

europe_crop <- europe %>% 
   st_make_valid() %>% 
    st_crop(xmin = -15, ymin = 25, xmax = 30, ymax = 55) # xmin = -25, ymin = 25, xmax = 50, ymax = 70

# europe_crop2 <- europe %>% 
#    st_make_valid() %>% 
#     st_crop(xmin = -25, ymin = 25, xmax = 50, ymax = 70) # xmin = -25, ymin = 25, xmax = 50, ymax = 70

centroid_berlin <- berlin %>% 
  st_transform(crs = 4326) %>% 
  st_centroid()
```


```{r fig.width = 9, fig.height = 6}
(eu_map2 <- ggplot() +
    geom_sf(data = europe_crop, col = "black", fill = "grey90") +
    geom_sf(data = centroid_berlin, size = 6, pch = 22, linewidth = 3, fill = "red", col = "red") +
    geom_sf(data = centroid_berlin, col = "red", size = 4, pch = 22, fill = "grey90") +
    coord_sf(xlim = c(-15,30.1), ylim = c(35,55.1), expand = FALSE) +
    scale_x_continuous(breaks = seq(-15, 30, by = 15)) + 
    scale_y_continuous(breaks = seq(35, 55, by = 10)) + 
    theme(plot.background = element_rect(fill = "transparent", colour = NA))
)
```

## Final map
```{r fig.width = 9, fig.height = 6}
plot.with.inset2 <-
  ggdraw() +
  draw_plot(map_berlin2) +
  draw_plot(eu_map2, x = 0.495, y = .68, width = .25, height = .25)

plot.with.inset2
```

### Save map
```{r}
# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Study_area_20240601.tiff"),
#         # width = 85,
#         # height = 85,
#         # units = "mm",
#        dpi = 600)
```


# Squirrels binary
```{r}
ggplot(data = env_var, mapping = aes(x = squirrels_cam_binary, fill = squirrels_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 400),
    breaks = seq(0, 400, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) +
  labs(x = "Squirrel") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") +
  coord_cartesian(clip = "off")
```


# Urban data exploration
## Distance to border
```{r}
ggplot(data = env_var, mapping = aes(x = distance_to_border, y = project_phase, fill = project_phase)) + 
  stat_halfeye(mapping = aes(
    #color = project_phase, 
    #fill = project_phase
    ),
    width = 0.7, 
    .width = 0, 
    #adjust = 0.5, 
    justification = -0.1,
    point_color = NA) + 
   geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.01, height = 0.01)
    ) + 
  scale_x_continuous(
    limits = c(0, 11500),
    breaks = seq(0, 11500, by = 5000),
    expand = c(.01, .001)) +
  scale_y_discrete(
    expand = c(0.05, 0.001)) + 
  labs(x = "Distance to city border [m]",
       y = "Project phase") + 
  scale_fill_manual(values = pal_4)

# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_Distance_to_border.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```


```{r}
# Other possibilities
ggplot(data = env_var, mapping = aes(x = distance_to_border, y = project_phase)) + 
  stat_halfeye(mapping = aes(
    color = project_phase, 
    fill = project_phase),
    width = 0.7, 
    .width = 0, 
    #adjust = 0.5, 
    #justification = -.3,
    point_color = NA)


ggplot(data = env_var, 
       mapping = aes(x = distance_to_border, 
                     group = project_phase, 
                     fill = project_phase, 
                     colour = project_phase)) + 
  geom_density(alpha = .4)


ggplot(data = env_var, 
       mapping = aes(x = distance_to_border, 
                     group = project_phase, 
                     fill = project_phase, 
                     colour = project_phase)) + 
  geom_density(position = "fill") # , alpha = .4
```

## Imperviousness
```{r}
ggplot(data = env_var, mapping = aes(x = imperviousness_2018, y = project_phase, fill = project_phase)) + 
  stat_halfeye(mapping = aes(
    #color = project_phase, 
    #fill = project_phase
    ),
    width = 0.7, 
    .width = 0, 
    #adjust = 0.5, 
    justification = -0.1,
    point_color = NA) + 
   geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.01, height = 0.01)
    ) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) +
  scale_y_discrete(
    expand = c(0.09, 0.001)) + 
  labs(x = "Imperviousness [%]",
       y = "Project phase") + 
  scale_fill_manual(values = pal_4)


# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_Imperviousness.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

```{r}
ggplot(data = env_var, mapping = aes(x = imperviousness_2018, y = project_phase)) + 
  stat_halfeye(mapping = aes(
    color = project_phase, 
    fill = project_phase),
    width = 0.7, 
    .width = 0, 
    #adjust = 0.5, 
    justification = -0.1,
    point_color = NA) + 
   geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.01, height = 0.01)
    ) 


ggplot(data = env_var, 
       mapping = aes(x = imperviousness_2018, 
                     group = project_phase, 
                     fill = project_phase, 
                     colour = project_phase)) + 
  geom_density(alpha = .4)


ggplot(data = env_var, 
       mapping = aes(x = imperviousness_2018, 
                     group = project_phase, 
                     fill = project_phase, 
                     colour = project_phase)) + 
  geom_density(position = "fill") # , alpha = .4
```

## Noise
```{r}
ggplot(data = env_var, mapping = aes(x = noise_2017, y = project_phase, fill = project_phase)) + 
  stat_halfeye(mapping = aes(
    #color = project_phase, 
    #fill = project_phase
    ),
    width = 0.7, 
    .width = 0, 
    #adjust = 0.5, 
    justification = -0.1,
    point_color = NA) + 
   geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.01, height = 0.01)
    ) + 
  scale_x_continuous(
    limits = c(30, 80),
    breaks = seq(30, 80, by = 25),
    expand = c(.01, .001)) +
  scale_y_discrete(
    expand = c(0.09, 0.001)) + 
  labs(x = "Noise level [%]",
       y = "Project phase") + 
  scale_fill_manual(values = pal_4)


# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_Noise.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

## Population density
```{r}
ggplot(data = env_var, mapping = aes(x = pop_2019, y = project_phase, fill = project_phase)) + 
  stat_halfeye(mapping = aes(
    #color = project_phase, 
    #fill = project_phase
    ),
    width = 0.7, 
    .width = 0, 
    #adjust = 0.5, 
    justification = -0.1,
    point_color = NA) + 
   geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.01, height = 0.01)
    ) + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.01, .001)) +
  scale_y_discrete(
    expand = c(0.09, 0.001)) + 
  labs(x = "Human population density",
       y = "Project phase") + 
  scale_fill_manual(values = pal_4)


# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_Pop_dens.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

# Garden data exploration
## Season
```{r}
ggplot(data = env_var, mapping = aes(x = Season, fill = project_phase)) + # fill = dogs_binary 
  geom_bar(position = "dodge") + 
 scale_y_continuous(
   limits = c(0, 150),
   breaks = seq(0, 150, by = 50),
   expand = c(.001, .001)) +
 scale_x_discrete(expand = c(0.2, 0.001), labels = c("Autumn", "Spring")) +
  labs(x = "Season", 
       y = "nr of stations", 
       fill = "Project phase") + 
  scale_fill_manual(values = pal_4) + #, guide = "none"
  theme(legend.position = "right")

# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_season.tiff"),
#        width = 1700,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

## Lockdown
```{r}
ggplot(data = env_var, mapping = aes(x = lockdown, fill = project_phase)) + # fill = dogs_binary 
  geom_bar(position = "dodge") + 
 scale_y_continuous(
   limits = c(0, 150),
   breaks = seq(0, 150, by = 50),
   expand = c(.001, .001)) +
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) +
  labs(x = "Lockdown", 
       y = "nr of stations", 
       fill = "Project phase") + 
  scale_fill_manual(values = pal_4) + #, guide = "none"
  theme(legend.position = "right")

# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_lockdown.tiff"),
#        width = 1700,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

## garden size
```{r}
ggplot(data = env_var, mapping = aes(x = garden_size, y = project_phase, fill = project_phase)) + 
  stat_halfeye(mapping = aes(
    #color = project_phase, 
    #fill = project_phase
    ),
    width = 0.7, 
    .width = 0, 
    #adjust = 0.5, 
    justification = -0.1,
    point_color = NA) + 
   geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.01, height = 0.01)
    ) + 
  scale_x_continuous(
    limits = c(0, 5010),
    breaks = seq(0, 5000, by = 1000),
    expand = c(.01, .001)) +
  scale_y_discrete(
    expand = c(0.09, 0.001)) + 
  labs(x = "Garden size",
       y = "Project phase") + 
  scale_fill_manual(values = pal_4)


# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_garden_size.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```
## Dogs
```{r}
ggplot(data = env_var, mapping = aes(x = dogs_binary, fill = project_phase)) + # fill = dogs_binary 
  geom_bar(position = "dodge") + 
 scale_y_continuous(
   limits = c(0, 150),
   breaks = seq(0, 150, by = 50),
   expand = c(.001, .001)) +
 scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) +
  labs(x = "Dog", 
       y = "nr of stations", 
       fill = "Project phase") + 
  #scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_4) + #, guide = "none"
  theme(legend.position = c(0.77, 0.77))
  #coord_cartesian(clip = "off") 

# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_dogs.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

## Cats on cameras
```{r}
ggplot(data = env_var, mapping = aes(x = cats_cam_binary, fill = project_phase)) + # fill = dogs_binary 
  geom_bar(position = "dodge") + 
 scale_y_continuous(
   limits = c(0, 150),
   breaks = seq(0, 150, by = 50),
   expand = c(.001, .001)) +
 scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) +
  labs(x = "Cats on cams",
       y = "nr of stations",
       fill = "Project phase") +
  scale_fill_manual(values = pal_4) + #, guide = "none"
  theme(legend.position = c(0.23, 0.77))

# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_cats_on_cams.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

## Martens on cams
```{r}
ggplot(data = env_var, mapping = aes(x = marten_cam_binary, fill = project_phase)) + # fill = dogs_binary 
  geom_bar(position = "dodge") + 
 scale_y_continuous(
   limits = c(0, 150),
   breaks = seq(0, 150, by = 50),
   expand = c(.001, .001)) +
 scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) +
  labs(x = "Martens on cams",
       y = "nr of stations",
       fill = "Project phase") +
  scale_fill_manual(values = pal_4) + #, guide = "none"
  theme(legend.position = c(0.77, 0.77))

# # Save the plot
# ggsave(filename = here::here("plots",
#                              "01_environmental_variables",
#                              "Env_expl_martens_on_cams.tiff"),
#        width = 1200,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```

```{r}
# Marten cam binary
ggplot(data = env_var, mapping = aes(x = marten_cam_binary, fill = marten_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Martens on cameras", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 
```

# Other
```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = project_phase)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(x = "Project phase", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_4, guide = "none") +
  scale_fill_manual(values = pal_4, guide = "none") + 
  coord_cartesian(clip = "off") 

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = Season)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(x = "Season", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = lockdown)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(x = "Lockdown", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = garden_type)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(x = "Garden type", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Garden size
ggplot(data = env_var, mapping = aes(x = Station, y = garden_size)) + 
  geom_point(colour = "#303B4A") + 
  scale_y_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 500),
    expand = c(.02, .001)) +
  scale_x_continuous(expand = c(0.1, 0.001)) + 
  labs(y = "Garden size") + 
  coord_cartesian(clip = "off") 

# Dogs
ggplot(data = env_var, mapping = aes(x = dogs_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Cat", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Cats cam binary
ggplot(data = env_var, mapping = aes(x = cats_cam_binary, fill = cats_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Cats on cameras", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Marten cam binary
ggplot(data = env_var, mapping = aes(x = marten_cam_binary, fill = marten_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Martens on cameras", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 


# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Trees of interest", 
       y = "nr of stations") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Fence height
ggplot(data = env_var, mapping = aes(x = Station, y = fence_height)) + 
  geom_point(colour = "#303B4A") + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.001, .001)) +
  scale_x_continuous(expand = c(0.1, 0.001)) + 
  labs(y = "Fence height") + 
  coord_cartesian(clip = "off") 

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = compost)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) +
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(x = "Compost type", y = "nr of stations") + 
  scale_colour_manual(values = pal_3, guide = "none") +
  scale_fill_manual(values = pal_3, guide = "none") + 
  coord_cartesian(clip = "off") 
```

```{r}
table(env_var$dogs_binary)
table(env_var$cats_binary)
table(env_var$cats_cam_binary)
table(env_var$marten_cam_binary)
table(env_var$trees_of_interest)
```

# Correlation binary garden variables

## Dogs

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(title = "Dogs vs Project phase", x = "Project phase") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(title = "Dogs vs Season", x = "Season") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(title = "Dogs vs Lockdown", x = "Lockdown") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(title = "dogs vs garden type", x = "Garden type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 500),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("no", "yes")) + 
  labs(title = "Dogs vs cats", x = "Cat") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("no", "yes")) + 
  labs(title = "Dogs vs trees of interest", x = "Trees of interest") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  labs(title = "Dogs vs compost", x = "Compost type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off") 
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)
```

## Cats

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = cats_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Cat", 
       y = "Distance to border", 
       title = "Cats vs Distance to border") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")

# Imperviousness
ggplot(data = env_var, mapping = aes(x = cats_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Cat", 
       y = "Imperviousness", 
       title = "Cats vs Imperviousness") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")

# Noise
ggplot(data = env_var, mapping = aes(x = cats_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Cat", 
       y = "Noise", 
       title = "Cats vs Noise") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")

# Population density
ggplot(data = env_var, mapping = aes(x = cats_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Cat", 
       y = "Population density/ha", 
       title = "Cats vs Population density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")

# Tree cover density
ggplot(data = env_var, mapping = aes(x = cats_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(
    expand = c(0.2, 0.001), 
    labels = c("No", "Yes")) + 
  labs(x = "Cat", 
       y = "Tree cover density", 
       title = "Cats vs Tree cover density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Project phase", x = "Project phase") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Season", x = "Season") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Lockdown", x = "Lockdown") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Garden type", x = "Garden type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Garden size
ggplot(data = env_var, mapping = aes(x = cats_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 500),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Garden size", 
       title = "Cats vs garden size") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Dogs
ggplot(data = env_var, mapping = aes(x = dogs_binary, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs dogs", x = "Dog") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Cats vs trees of interest", x = "Trees of interest") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Fence height
ggplot(data = env_var, mapping = aes(x = cats_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Fence height", 
       title = "Cats vs fence height") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs compost", x = "Compost type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")
```

## Cats cam binary

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Project phase", x= "Project phase") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Season", x= "Season") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Lockdown", x= "Lockdown") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "dogs vs garden type", x= "Garden type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 500),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs cats", x= "Cat") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Dogs vs trees of interest", x= "Trees of interest") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs compost", x= "Compost type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)
```

## Marten cam binary

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Project phase", x= "Project phase") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Season", x= "Season") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Lockdown", x= "Lockdown") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "dogs vs garden type", x= "Garden type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 500),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs cats", x= "Cat") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Dogs vs trees of interest", x= "Trees of interest") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs compost", x= "Compost type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)
```


## Trees of interest

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Distance to border", 
       title = "Trees of interest vs Distance to border") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Imperviousness
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Imperviousness", 
       title = "Trees of interest vs Imperviousness") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Noise
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Noise", 
       title = "Trees of interest vs Noise") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Population density
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Population density/ha", 
       title = "Trees of interest vs Population density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Tree cover density
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
    width = 0.7, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Tree cover density", 
       title = "Trees of interest vs Tree cover density") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs Project phase", x= "Project phase") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs Season", x= "Season") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs Lockdown", x= "Lockdown") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs garden type", x= "Garden type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")

# Garden size
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 500),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Garden size", 
       title = "Trees of interest vs garden size") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Dogs
ggplot(data = env_var, mapping = aes(x = dogs_binary, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs dogs", x= "Dogs") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs cats", x= "Cats") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  coord_cartesian(clip = "off")

# Fence height
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Fence height", 
       title = "Trees of interest vs fence height") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes")) + 
  coord_cartesian(clip = "off")

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 500),
    breaks = seq(0, 500, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs compost", x= "Compost type") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001)) + 
  coord_cartesian(clip = "off")
```

There are so many gardens with trees of interest that we do not consider this variable in the further analysis.

***

<details><summary>Session Info</summary>

```{r sessionInfo}
## DO NOT REMOVE!
## We store the settings of your computer and the current versions of the
## packages used to allow for reproducibility
Sys.time()
#git2r::repository() ## uncomment if you are using GitHub
sessionInfo()
```

</details>
