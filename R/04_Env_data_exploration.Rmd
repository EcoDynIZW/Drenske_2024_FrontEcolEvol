---
title: "Squirrel activity: Exploration of the environmental data" ## name of your project and analysis step
description: |
    The aim of this study is...
author:
    ## author information; single arguemnts can be deleted if not needed
    - name: "John Smith"
      url: https://izw-berlin.de/en/john-smith-en.html  
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0000-0000-0000
    - name: "Jane Doe"
      url: https://janedoe.com
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
    ## add more authors with the same intendation and styling if needed 
    ## a new author always starts with a hyphen!
date: "`r Sys.Date()`"
output: 
    distill::distill_article:
        highlight: kate      ## styling of code
        code_folding: TRUE  ## if `true` you can expand and shrink code chunks
        toc: true            ## if `true` adds a table of content
        toc_depth: 2         ## level to be displayed in the table of content
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, 
                      dev = "ragg_png", fig.width = 5, fig.height = 4, dpi = 600, retina = 1)
Sys.setlocale("LC_TIME", "C")
```

-   **Research question:**
-   **Study area:**
-   **Data:**

# Setup

```{r packages}
# install the package librarian, it loads and installs (if necessary) the specified packages from CRAN, GitHub or Bioconductor

#devtools::install_github("DesiQuintans/librarian")
librarian::shelf(update_all = FALSE,
                 #camtrapR,
                 colorspace, 
                 corrplot,
                 #dplyr,
                 EcoDynIZW / d6berlin,
                 extrafont, 
                 #evaluate, 
                 gdata, 
                 #ggplot2, 
                 ggdist, 
                 ggpubr, 
                 here, 
                 #janitor, 
                 #lubridate, 
                 #maptools, 
                 #ropenscilabs / ochRe,
                 osmdata,
                 # "optimbase", maybe needed but has to be installed from the CRAN archive https://cran.r-project.org/web/packages/optimbase/index.html
                 #plyr,
                 raster,
                 #readxl, 
                 #rgdal, 
                 #rgeos, 
                 #rjags, 
                 #rlecuyer, 
                 scico,
                 sf, 
                 #showtext, 
                 skimr, 
                 #snowfall, 
                 #sp, 
                 #stringr, 
                 tidyverse, 
                 #vroom
                 )
```

# Data

```{r data}
#loading the environmental variables and using only the user IDs that are within the cov table
env_var <- readRDS(here::here("output", 
                              "data-proc", 
                              "all_seasons",
                              "env_var_binary_species_20230223.RDS"))
```

## Palettes

```{r palette}
# darkdarkblue beige greyblue brown red
pal_5 <- c("#303B4A", "#E4CAA5", "#4D6476", "#837461", "#C83649") # 
pal_3 <- c("#E4CAA5", "#4D6476", "#837461")
pal_2 <- c("#E4CAA5", "#4D6476")
```

## Load fonts

```{r message=FALSE, include=FALSE}
#font_import()
loadfonts(device = "win")
fonts()
```

# Map of the camera stations

We create a map to plot the locations of the camera stations

```{r}
# Test map with train stations
# base_map_imp() + 
#   geom_sf(data = sf_metro)
```

```{r}
ct_spatial<-
  st_as_sf(x = env_var,
           coords = c("Long","Lat"), # name the columns with the coordinates
           remove=F, # dont remove long lat columns
           crs=32633) %>% # crs of the points
  st_transform(crs = 3035)

#ct_spatial$project_phase <- as.factor(ct_spatial$project_phase)
```

```{r}
base_map_imp() + 
  geom_sf(data = ct_spatial) + # , aes(colour = project_phase)
  geom_sf(data = ct_spatial[c(15,473,517,575,595,611),], color = "red")
```


```{r}
base_map_imp() + 
  geom_sf(data = ct_spatial, aes(colour = project_phase)) + 
  scale_color_manual(values = c( "1" = "red", "2" = "blue", "3" = "orange", "4" = "green", "5" = "purple"))
```

# Squirrels binary
```{r}
ggplot(data = env_var, mapping = aes(x = squirrels_cam_binary, fill = squirrels_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 400),
    breaks = seq(0, 400, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Squirrel") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

# Urban data exploration

```{r}
## Distance to border
ggplot(data = env_var, mapping = aes(x = Station, y = distance_to_border)) + 
  geom_point(colour = "#303B4A") +
  scale_y_continuous(
    limits = c(0, 15000),
    breaks = seq(0, 15000, by = 5000),
    expand = c(.02, .001)) +
  labs(x = "Station", y = "Distance to border", title = "Distance to border") +
  theme_pubr() +
  theme(legend.position = "none",
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2),
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) +
  font(object = "xy.text", family = "Roboto", size = 11) +
  scale_x_discrete(expand = c(0.03, 0.001))

## Imperviousness 2018
ggplot(data = env_var, mapping = aes(x = Station, y = imperviousness_2018)) + 
  geom_point(colour = "#303B4A") +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Station", y = "Imperviousness", title = "Imperviousness") +
  theme_pubr() +
  theme(legend.position = "none",
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2),
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) +
  font(object = "xy.text", family = "Roboto", size = 11) +
  scale_x_discrete(expand = c(0.03, 0.001))

## Noise 2017
ggplot(data = env_var, mapping = aes(x = Station, y = noise_2017)) + 
  geom_point(colour = "#303B4A") +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Station", y = "Noise", title = "Noise") +
  theme_pubr() +
  theme(legend.position = "none",
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2),
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) +
  font(object = "xy.text", family = "Roboto", size = 11) +
  scale_x_discrete(expand = c(0.03, 0.001))

## Population density 2019
ggplot(data = env_var, mapping = aes(x = Station, y = pop_2019)) + 
  geom_point(colour = "#303B4A") +
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Station", y = "Population density", title = "Population density") +
  theme_pubr() +
  theme(legend.position = "none",
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2),
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) +
  font(object = "xy.text", family = "Roboto", size = 11) +
  scale_x_discrete(expand = c(0.03, 0.001))

### Tree cover
# Local tree cover
ggplot(data = env_var, mapping = aes(x = Station, y = Local_tree_cover)) + 
  geom_point(colour = "#303B4A") +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Station", 
       y = "Tree cover", 
       title = "Local tree cover (by Citizens)") + 
  theme_pubr() +
  theme(legend.position = "none",
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2),
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) +
  font(object = "xy.text", family = "Roboto", size = 11) +
  scale_x_discrete(expand = c(0.03, 0.001))

# Tree cover density 2019
ggplot(data = env_var, mapping = aes(x = Station, y = tree_cover_2018)) +
  geom_point(colour = "#303B4A") +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Station", y = "Tree cover", title = "Tree cover") +
  theme_pubr() +
  theme(legend.position = "none",
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2),
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) +
  font(object = "xy.text", family = "Roboto", size = 11) +
  scale_x_discrete(expand = c(0.03, 0.001))

# Comparison of local tree cover and tree cover density
ggplot(data = env_var, mapping = aes(x = Local_tree_cover, y = tree_cover_2018)) + 
  geom_point(colour = "#303B4A") + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Local tree cover (by Citizens)", 
       y = "Tree cover", 
       title = "Comparison of Tree cover values") + 
  theme_pubr() +
  theme(legend.position = "none",
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2),
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) +
  font(object = "xy.text", family = "Roboto", size = 11)
```

# Garden data exploration

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = project_phase)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 200),
    breaks = seq(0, 200, by = 50),
    expand = c(.001, .001)) +
  labs(x = "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_5, guide = "none") +
  scale_fill_manual(values = pal_5, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = Season)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = lockdown)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = garden_type)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = Station, y = garden_size)) + 
  geom_point(colour = "#303B4A") + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 500),
    expand = c(.02, .001)) +
  labs(y = "Garden size") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm")) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_x_continuous(expand = c(0.1, 0.001))

# Dogs
ggplot(data = env_var, mapping = aes(x = dogs_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 650),
    breaks = seq(0, 650, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Dog") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 650),
    breaks = seq(0, 650, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Cat") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Cats cam binary
ggplot(data = env_var, mapping = aes(x = cats_cam_binary, fill = cats_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 650),
    breaks = seq(0, 650, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Cats on cameras") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Marten cam binary
ggplot(data = env_var, mapping = aes(x = marten_cam_binary, fill = marten_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 650),
    breaks = seq(0, 650, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Martens on cameras") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Raccoon cam binary
ggplot(data = env_var, mapping = aes(x = raccoon_cam_binary, fill = raccoon_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 650),
    breaks = seq(0, 650, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Raccoons on cameras") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Fox cam binary
ggplot(data = env_var, mapping = aes(x = fox_cam_binary, fill = fox_cam_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 650),
    breaks = seq(0, 650, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Foxes on cameras") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Trees of interest") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# 

# Fence height
ggplot(data = env_var, mapping = aes(x = Station, y = fence_height)) + 
  geom_point(colour = "#303B4A") + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.001, .001)) +
  labs(y = "Fence height") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm")) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_x_continuous(expand = c(0.1, 0.001))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = compost)) + 
geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 400),
    breaks = seq(0, 400, by = 100),
    expand = c(.001, .001)) +
  labs(x = "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth = 2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_3, guide = "none") +
  scale_fill_manual(values = pal_3, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

```{r}
table(env_var$dogs_binary)
table(env_var$cats_binary)
table(env_var$cats_cam_binary)
table(env_var$marten_cam_binary)
table(env_var$raccoon_cam_binary)
table(env_var$fox_cam_binary)
table(env_var$trees_of_interest)
```

# Correlation binary garden variables

## Dogs

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Project phase", x= "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Season", x= "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Lockdown", x= "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "dogs vs garden type", x= "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs cats", x= "Cat") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Dogs vs trees of interest", x= "Trees of interest") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs compost", x= "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)
```

## Cats

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = cats_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Distance to border", 
       title = "Cats vs Distance to border") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Imperviousness
ggplot(data = env_var, mapping = aes(x = cats_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Imperviousness", 
       title = "Cats vs Imperviousness") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Noise
ggplot(data = env_var, mapping = aes(x = cats_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Noise", 
       title = "Cats vs Noise") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Population density
ggplot(data = env_var, mapping = aes(x = cats_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Population density/ha", 
       title = "Cats vs Population density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Tree cover density
ggplot(data = env_var, mapping = aes(x = cats_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Tree cover density", 
       title = "Cats vs Tree cover density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Project phase", x= "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Season", x= "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Lockdown", x= "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = cats_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs Garden type", x= "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = cats_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Garden size", 
       title = "Cats vs garden size") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Dogs
ggplot(data = env_var, mapping = aes(x = dogs_binary, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs dogs", x= "Dog") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Cats vs trees of interest", x= "Trees of interest") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Fence height
ggplot(data = env_var, mapping = aes(x = cats_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Cat", 
       y = "Fence height", 
       title = "Cats vs fence height") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = cats_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Cats vs compost", x= "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

## Cats cam binary

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Project phase", x= "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Season", x= "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Lockdown", x= "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "dogs vs garden type", x= "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs cats", x= "Cat") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Dogs vs trees of interest", x= "Trees of interest") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs compost", x= "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)
```

## Marten cam binary

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Project phase", x= "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Season", x= "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Lockdown", x= "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "dogs vs garden type", x= "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs cats", x= "Cat") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Dogs vs trees of interest", x= "Trees of interest") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs compost", x= "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)
```

## Raccoon cam binary

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Project phase", x= "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Season", x= "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Lockdown", x= "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "dogs vs garden type", x= "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs cats", x= "Cat") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Dogs vs trees of interest", x= "Trees of interest") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs compost", x= "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)

```

## Fox cam binary

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Distance to border", 
       title = "Dogs vs Distance to border") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Imperviousness
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Imperviousness", 
       title = "Dogs vs Imperviousness") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Noise
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Noise", 
       title = "Dogs vs Noise") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Population density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Population density/ha", 
       title = "Dogs vs Population density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Tree cover density
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Tree cover density", 
       title = "Dogs vs Tree cover density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Project phase", x= "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Season", x= "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs Lockdown", x= "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = dogs_binary)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "dogs vs garden type", x= "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Garden size", 
       title = "Dogs vs garden size") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs cats", x= "Cat") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Trees of interest
ggplot(data = env_var, mapping = aes(x = trees_of_interest, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Dogs vs trees of interest", x= "Trees of interest") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Fence height
ggplot(data = env_var, mapping = aes(x = dogs_binary, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Dog", 
       y = "Fence height", 
       title = "Dogs vs fence height") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = dogs_binary)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.001, .001)) + 
  labs(title = "Dogs vs compost", x= "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

```{r}
env_var %>%
  dplyr::count(garden_type, dogs_binary)

```

## Trees of interest

### Urban scale

```{r}
# Distance to border
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = distance_to_border)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 12000),
    breaks = seq(0, 12000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Distance to border", 
       title = "Trees of interest vs Distance to border") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Imperviousness
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = imperviousness_2018)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Imperviousness", 
       title = "Trees of interest vs Imperviousness") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Noise
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = noise_2017)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Noise", 
       title = "Trees of interest vs Noise") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Population density
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = pop_2019)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Population density/ha", 
       title = "Trees of interest vs Population density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Tree cover density
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = tree_cover_2018)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Tree cover density", 
       title = "Trees of interest vs Tree cover density") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))
```

### Garden scale

```{r}
# Project phase
ggplot(data = env_var, mapping = aes(x = project_phase, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs Project phase", x= "Project phase") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Season
ggplot(data = env_var, mapping = aes(x = Season, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs Season", x= "Season") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Lockdown
ggplot(data = env_var, mapping = aes(x = lockdown, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs Lockdown", x= "Lockdown") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))


# Garden type
ggplot(data = env_var, mapping = aes(x = garden_type, fill = trees_of_interest)) + #y = n, 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs garden type", x= "Garden type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))

# Garden size
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = garden_size)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 8000),
    breaks = seq(0, 8000, by = 1000),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Garden size", 
       title = "Trees of interest vs garden size") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Dogs
ggplot(data = env_var, mapping = aes(x = dogs_binary, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  labs(title = "")+ 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs dogs", x= "Dogs") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Cats
ggplot(data = env_var, mapping = aes(x = cats_binary, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs cats", x= "Cats") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes"))

# Fence height
ggplot(data = env_var, mapping = aes(x = trees_of_interest, y = fence_height)) + 
  stat_halfeye(mapping = aes(
    color = trees_of_interest, 
    fill = trees_of_interest),
  width = 0.7, 
  .width = 0, 
  adjust = 0.5, 
  justification = -.3,
  point_color = NA) +
  geom_boxplot(mapping = aes(
    color = trees_of_interest, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = trees_of_interest), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 300),
    breaks = seq(0, 300, by = 50),
    expand = c(.02, .001)) +
  labs(x = "Trees of interest", 
       y = "Fence height", 
       title = "Trees of interest vs fence height") + 
  theme_pubr() + 
  theme(panel.grid.minor = element_blank(),
        panel.grid.major.y = element_blank(), 
        legend.position = "none", 
        panel.background = element_rect(fill = "white"), 
        plot.background = element_rect(fill = "white"),
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 2), 
        axis.ticks.length = unit(0.25, "cm"), 
        plot.margin = margin(6, 10, 4, 4)) + 
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("No", "Yes"))

# Compost type
ggplot(data = env_var, mapping = aes(x = compost, fill = trees_of_interest)) + 
  geom_bar(position = "dodge") + 
  scale_y_continuous(
    limits = c(0, 600),
    breaks = seq(0, 600, by = 100),
    expand = c(.008, .001)) + 
  labs(title = "Trees of interest vs compost", x= "Compost type") + 
  theme_pubr() + 
  theme(legend.position = "none", 
        panel.border = element_rect(colour = "black", fill=NA, linewidth=2), 
        axis.ticks = element_line(colour = "black", linewidth = 1.5),
        axis.ticks.length = unit(0.2, "cm"),
        plot.margin = margin(6, 10, 4, 4)) +
  labs_pubr(base_family = "Zilla Slab", base_size = 15) + 
  font(object = "xy.text", family = "Roboto", size = 11) + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  scale_x_discrete(expand = c(0.2, 0.001))
```

There are so many gardens with trees of interest that we do not consider this variable in the further analysis

***

<details><summary>Session Info</summary>

```{r sessionInfo}
## DO NOT REMOVE!
## We store the settings of your computer and the current versions of the
## packages used to allow for reproducibility
Sys.time()
#git2r::repository() ## uncomment if you are using GitHub
sessionInfo()
```

</details>
