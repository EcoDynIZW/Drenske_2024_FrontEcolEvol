---
title: "Squirrel activity: Exploration" ## name of your project and analysis step
description: |
    The aim of the study is to investigate the influence of altered environmental urban parameters and direct human disturbance expressed by the lockdown together with animal predator risk parameters on the general activity of squirrels
author:
    - name: "Sinah Drenske"
      affiliation: Leibniz Institute for Zoo and Wildlife Research, Technical University Berlin
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0002-2247-6507
    - name: "Julie Louvrier"
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0003-1252-1746
    - name: "Marius Grabow"
      affiliation: Leibniz Institute for Zoo and Wildlife Research, Technical University Berlin
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0003-0702-9642
    - name: "Conny Landgraf"
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      #orcid_id: 0000-0000-0000-0000
    - name: "Stephanie Kramer-Schadt"
      affiliation: Leibniz Institute for Zoo and Wildlife Research, Technical University Berlin
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0002-9269-4446
    - name: "Aimara Planillo"
      affiliation: Leibniz Institute for Zoo and Wildlife Research
      affiliation_url: https://izw-berlin.de/en/
      orcid_id: 0000-0001-6763-9923
date: "`r Sys.Date()`"
output: 
    distill::distill_article:
        highlight: kate      ## styling of code
        code_folding: TRUE  ## if `true` you can expand and shrink code chunks
        toc: true            ## if `true` adds a table of content
        toc_depth: 4         ## level to be displayed in the table of content
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, 
                      dev = "ragg_png", fig.width = 9, fig.height = 6, dpi = 600, retina = 1)
Sys.setlocale("LC_TIME", "C")
```

* **Research question:** Which risk effects increase or decrease the overall activity of red squirrels in urban gardens?  
* **Study area:** Berlin 2019-2020 
* **Data:** Detection histories of squirrels, martens and cats from 4 seasons (spring 2019, autumn 2019, spring 2020, autumn 2020), already filtered as in Louvrier et al. 2021 + environmental information on camera stations.

# Setup

```{r packages}
# install the package of our department
#remotes::install_github("EcoDynIZW/d6")

#this function loads and installs (if necessary) the specified packages from CRAN or GitHub. No previously installed packages are reinstalled or updated by default

d6::simple_load(c(#"camtrapR",
                  "colorspace", 
                  "corrplot",
                  "EcoDynIZW/d6berlin",
                  "extrafont", 
                  "gdata", 
                  "ggdist", 
                  "ggpubr", 
                  "here", 
                  "osmdata",
                  "raster",
                  "scico",
                  "sf", 
                  "skimr", 
                  "tidyverse" 
))
```

Set theme for ggplots
```{r}
theme_set(
  theme(
    legend.position = "none",
    panel.grid = element_blank(),
    panel.background = element_rect(fill = "white"),
    panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
    axis.ticks = element_line(colour = "black", linewidth = 1.5),
    axis.ticks.length = unit(0.2, "cm"), 
    title = element_text(family = "Zilla Slab", size = 15),
    axis.text = element_text(family = "Roboto", size = rel(0.87))))
```


# Data

```{r data}
#loading the environmental variables and using only the user IDs that are within the cov table
env_var <- readRDS(here::here("output", 
                              "data-proc", 
                              "01_overall_activity",
                              "env_var_binary_species_20230305.RDS"))

# CT data
CT_per_station <- readRDS(here::here("output", 
                                     "data-proc", 
                                     "01_overall_activity",
                                     "CT_species_interest_per_station_20230305.RDS"))

CT_squirrels_station <- readRDS(here::here("output", 
                                           "data-proc", 
                                           "01_overall_activity",
                                           "CT_squirrels_per_station_20230305.RDS"))
```

Define spatial object for maps
```{r}
ct_spatial <-
  st_as_sf(x = env_var,
           coords = c("Long","Lat"), # name the columns with the coordinates
           remove = F, # dont remove long lat columns
           crs = 32633) %>% # crs of the points
  st_transform(crs = 3035)
```

## Palettes
```{r palette}
# darkdarkblue beige greyblue brown | red
pal_4 <- c("#303B4A", "#E4CAA5", "#4D6476", "#837461") # , "#C83649"
pal_3 <- c("#E4CAA5", "#4D6476", "#837461")
pal_2 <- c("#E4CAA5", "#4D6476")
```

## Load fonts
```{r message=FALSE, include=FALSE}
#font_import()
loadfonts(device = "win")
fonts()
```

## Prepare facet labels
```{r}
# New facet label names for dose variable
predator_labs <- c("No", "Yes")
names(predator_labs) <- c("0", "1")
```


# Plots

Some tables for a small overview and then we make some plots to explore the relationship between the number of pictures and the environmental covariates


```{r}
# Garden size
CT_squirrels_station %>%
  group_by(dogs_binary) %>%
  summarise_at(vars(garden_size), funs(mean(., na.rm = TRUE)))

CT_squirrels_station %>%
  group_by(dogs_binary) %>%
  summarise_at(vars(garden_size), funs(range(., na.rm = TRUE)))
```

## Histogram of number of squirrel pictures per station
We have many zeros. Therefore we will use a negative binomial distribution for the glms
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = sum_pic)) + 
  geom_histogram(stat = "bin", position = "identity", fill = "#303B4A") +
  scale_y_continuous(
    limits = c(0, 400),
    breaks = seq(0, 400, by = 100),
    expand = c(.005, .001)) +
  scale_x_continuous(expand = c(.001, .001)) +
  labs(x = "Number of squirrel pictures per station")  +
  coord_cartesian(clip = "off")
```

## Time scale
### Project phase
```{r}
# Project phase and all species of interest
ggplot(data = CT_per_station, mapping = aes(x = project_phase, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = project_phase, 
    fill = project_phase),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = project_phase, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 510),
    breaks = seq(0, 500, by = 100),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.06, 0.001)) +
  labs(x = "Project phase", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_4, guide = "none") +
  scale_fill_manual(values = pal_4, guide = "none") + 
  coord_cartesian(clip = "off")


# Project phase and only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = project_phase, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = project_phase, 
    fill = project_phase),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = project_phase, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = project_phase), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.06, 0.001)) +
  labs(x = "Project phase", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_4, guide = "none") +
  scale_fill_manual(values = pal_4, guide = "none") + 
  coord_cartesian(clip = "off")
```

### Season
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = Season, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = Season, 
    fill = Season),
    width = 0.75, 
    .width = 0, 
    adjust = 0.5, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = Season, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = Season), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) +
  labs(x = "Season", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")

# ggsave(filename = here::here("plots","02_general_patterns", "squirrels_pics_season.png"),
#        width = 1200*1.25,
#        height = 1200,
#        units = "px",
#        dpi = 300)
```


### Lockdown
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = lockdown, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = lockdown, 
    fill = lockdown),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = lockdown, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = lockdown), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) +
  labs(x = "Lockdown", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

## Garden scale
### Garden type
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_type, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = garden_type, 
    fill = garden_type),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = garden_type, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = garden_type), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001)) +
  labs(x = "Garden type", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```


### Garden size
```{r}
# Only squirrels
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = sum_pic)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per garden size", 
       y = "Number of pictures", 
       x = bquote("Garden size in " * m^2)) + 
  scale_x_continuous(
    limits = c(0, 4100),
    breaks = seq(0, 4000, by = 500),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.008, .001)) + 
  coord_cartesian(clip = "off")
```

### Dogs

```{r}
Dog_map <- 
base_map_imp(color_intensity = 0.6, 
             legend_x = 0.9, 
             legend_y = 0.85) + 
  geom_sf(data = ct_spatial, 
          mapping = aes(colour = as.factor(dogs_binary))) + 
  scale_color_manual(values = c( "1" = "red", "0" = "black"), 
                     name = "Dog", labels = c("No", "Yes"))
Dog_map
```


```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = dogs_binary, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  labs(x = "Dogs at stations", 
       y = "Number of squirrel pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Dogs per Garden type
```{r}
# We have no dogs in allotments
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_type, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary,
    fill = dogs_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001)) + 
  labs(x = "Garden type",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Dogs and Garden size
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 1000),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~dogs_binary, labeller = labeller(dogs_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Dogs vs cats
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_binary, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary,
    fill = dogs_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), 
                   labels = c("no", "yes")) + 
  labs(x = "Cats",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Dogs vs cats per station
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_cam_binary, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary,
    fill = dogs_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), 
                   labels = c("no", "yes")) + 
  labs(x = "Cats per station",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Dogs vs martens
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = marten_cam_binary, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary,
    fill = dogs_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), 
                   labels = c("no", "yes")) + 
  labs(x = "Martens",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```


#### Dogs and Imperviousness
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~dogs_binary, labeller = labeller(dogs_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```


#### Dogs and Noise
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~dogs_binary, labeller = labeller(dogs_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Dogs and Population density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~dogs_binary, labeller = labeller(dogs_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Dogs and Tree cover density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2018, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +   
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~dogs_binary, labeller = labeller(dogs_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Dogs and Distance to border
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = sum_pic, fill = dogs_binary)) + 
  stat_halfeye(mapping = aes(
    color = dogs_binary, 
    fill = dogs_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = dogs_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = dogs_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 1000),
    expand = c(.02, .001)) + 
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~dogs_binary, labeller = labeller(dogs_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

### Cats
```{r}
Cat_map <- 
base_map_imp(color_intensity = 0.6, 
             legend_x = 0.9, 
             legend_y = 0.85) + 
  geom_sf(data = ct_spatial, 
          mapping = aes(colour = as.factor(cats_binary))) + 
  scale_color_manual(values = c( "1" = "red", "0" = "black"), 
                     name = "Cat", labels = c("No", "Yes"))
Cat_map
```


```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_binary, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001), 
                   labels = c("no", "yes")) + 
  labs(x = "cats_binary", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Cats per Garden type
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_type, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001)) + 
  labs(x = "Garden type",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Cats and Garden size
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 1000),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_binary, labeller = labeller(cats_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats vs dogs
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = dogs_binary, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), 
                   labels = c("no", "yes")) + 
  labs(x = "Dogs",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Cats as pets per station vs cats (as visitors) per station
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_cam_binary, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), 
                   labels = c("no", "yes")) + 
  labs(x = "Cats per station",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Cats vs martens
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = marten_cam_binary, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary,
    fill = cats_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), 
                   labels = c("no", "yes")) + 
  labs(x = "Martens",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```


#### Cats and Imperviousness
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_binary, labeller = labeller(cats_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```


#### Cats and Noise
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_binary, labeller = labeller(cats_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats and Population density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_binary, labeller = labeller(cats_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats and Tree cover density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2018, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_binary, labeller = labeller(cats_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats and Distance to border
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = sum_pic, fill = cats_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_binary, 
    fill = cats_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, 
                      guide = "none") +
  scale_fill_manual(values = pal_2, 
                    guide = "none") + 
  facet_wrap(~cats_binary, labeller = labeller(cats_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

### Cats cam binary
```{r}
Cat_cam_map <- 
base_map_imp(color_intensity = 0.6, 
             legend_x = 0.9, 
             legend_y = 0.85) + 
  geom_sf(data = ct_spatial, 
          mapping = aes(colour = as.factor(cats_cam_binary))) + 
  scale_color_manual(values = c( "1" = "red", "0" = "black"), 
                     name = "Cat", labels = c("No", "Yes"))
Cat_cam_map
```


```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_cam_binary, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary, 
    fill = cats_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  labs(x = "Cats per cam", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Cats per Garden type
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_type, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary,
    fill = cats_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001)) + 
  labs(x = "Garden type",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Cats and Garden size
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary, 
    fill = cats_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 1000),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_cam_binary, labeller = labeller(cats_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats vs dogs
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = dogs_binary, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary,
    fill = cats_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes")) + 
  labs(x = "Dogs",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```


#### Cats as visitors per station vs cats as pets per station
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_binary, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary,
    fill = cats_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes")) + 
  labs(x = "Cats as pets per station",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Cats (as visitors per station) vs martens
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = marten_cam_binary, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary,
    fill = cats_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes")) + 
  labs(x = "Martens",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```


#### Cats and Imperviousness
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary, 
    fill = cats_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_cam_binary, labeller = labeller(cats_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```


#### Cats and Noise
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary, 
    fill = cats_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_cam_binary, labeller = labeller(cats_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats and Population density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary, 
    fill = cats_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_cam_binary, labeller = labeller(cats_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats and Tree cover density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2018, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary, 
    fill = cats_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_cam_binary, labeller = labeller(cats_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Cats and Distance to border
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = sum_pic, fill = cats_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = cats_cam_binary, 
    fill = cats_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = cats_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = cats_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~cats_cam_binary, labeller = labeller(cats_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

### Marten cam binary
```{r}
Marten_map <- 
base_map_imp(color_intensity = 0.6, 
             legend_x = 0.9, 
             legend_y = 0.85) + 
  geom_sf(data = ct_spatial, 
          mapping = aes(colour = as.factor(marten_cam_binary))) + 
  scale_color_manual(values = c( "1" = "red", "0" = "black"), 
                     name = "Marten", labels = c("No", "Yes"))
Marten_map
```


```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = marten_cam_binary, y = sum_pic)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary, 
    fill = marten_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_discrete(expand = c(0.2, 0.001), labels = c("no", "yes")) + 
  labs(x = "Martens", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Martens per Garden type
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_type, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary,
    fill = marten_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001)) + 
  labs(x = "Garden type",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Martens and Garden size
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = garden_size, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary, 
    fill = marten_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 5500),
    breaks = seq(0, 5500, by = 1000),
    expand = c(.02, .001)) + 
  labs(x = "Garden size", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~marten_cam_binary, labeller = labeller(marten_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Martens vs dogs
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = dogs_binary, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary,
    fill = marten_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes")) + 
  labs(x = "Dogs",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Martens vs cats
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_binary, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary,
    fill = marten_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes")) + 
  labs(x = "Cats",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```

#### Martens vs cats per station
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = cats_cam_binary, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary,
    fill = marten_cam_binary),
    width = 0.7,
    .width = 0,
    adjust = 0.5,
    position = position_dodge(width = 1), 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary,
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))),
    width = 0.3,
    position = position_dodge(width = 1, preserve = "single"),
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary),
    color = "transparent",
    shape = 21,
    size = 3,
    stroke = .4,
    alpha = .5,
    #position = position_jitter(seed = 1, width = 0.12)) + 
    position = position_jitterdodge(seed = 1, jitter.width = 0.12, dodge.width = 1)) +
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) +
  scale_x_discrete(expand = c(0.001, 0.001), labels = c("no", "yes")) + 
  labs(x = "Cats per station",
       y = "Number of pictures") +
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  coord_cartesian(clip = "off")
```


#### Martens and Imperviousness
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary, 
    fill = marten_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Imperviousness", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~marten_cam_binary, labeller = labeller(marten_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```


#### Martens and Noise
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary, 
    fill = marten_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Noise", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~marten_cam_binary, labeller = labeller(marten_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Martens and Population density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary, 
    fill = marten_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  labs(x = "Population density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~marten_cam_binary, labeller = labeller(marten_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Martens and Tree cover density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2018, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary, 
    fill = marten_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  labs(x = "Tree cover density", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~marten_cam_binary, labeller = labeller(marten_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

#### Martens and Distance to border
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = sum_pic, fill = marten_cam_binary)) + 
  stat_halfeye(mapping = aes(
    color = marten_cam_binary, 
    fill = marten_cam_binary),
    width = 0.7, 
    .width = 0, 
    adjust = 0.9, 
    justification = -.3,
    point_color = NA) +
  geom_boxplot(mapping = aes(
    color = marten_cam_binary, 
    color = after_scale(darken(color, .1, space = "HLS")),
    fill = after_scale(desaturate(lighten(color, .8), .4))), 
    width = 0.32, 
    outlier.shape = NA) +
  geom_point(mapping = aes(
    fill = marten_cam_binary), 
    color = "transparent", 
    shape = 21, 
    size = 3, 
    stroke = .4,
    alpha = .5,
    position = position_jitter(seed = 1, width = 0.12)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  labs(x = "Distance to city border", 
       y = "Number of pictures per station") + 
  scale_colour_manual(values = pal_2, guide = "none") +
  scale_fill_manual(values = pal_2, guide = "none") + 
  facet_wrap(~marten_cam_binary, labeller = labeller(marten_cam_binary = predator_labs)) + 
  coord_cartesian(clip = "off")
```

## Urban scale
### Imperviousness
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = imperviousness_2018, y = sum_pic)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per imperviousness", 
       y = "Number of pictures", 
       x = "Imperviousness") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  coord_cartesian(clip = "off")
```


### Noise
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = noise_2017, y = sum_pic)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per noise", 
       y = "Number of pictures", 
       x = "Noise") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  coord_cartesian(clip = "off")
```

### Population density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = pop_2019, y = sum_pic)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per Population density", 
       y = "Number of pictures", 
       x = "Population density") + 
  scale_x_continuous(
    limits = c(0, 700),
    breaks = seq(0, 700, by = 100),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  coord_cartesian(clip = "off")
```

### Tree cover density
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = tree_cover_2018, y = sum_pic)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per Tree cover density", 
       y = "Number of pictures", 
       x = "Tree cover density") + 
  scale_x_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  coord_cartesian(clip = "off")
```


### Distance to border
```{r}
ggplot(data = CT_squirrels_station, mapping = aes(x = distance_to_border, y = sum_pic)) + 
  geom_point(colour = "#303B4A") + 
  labs(title = "Nr of pictures per station per distance to city border", 
       y = "Number of pictures", 
       x = "Distance to city border") + 
  scale_x_continuous(
    limits = c(0, 11300),
    breaks = seq(0, 11000, by = 2000),
    expand = c(.02, .001)) + 
  scale_y_continuous(
    limits = c(0, 100),
    breaks = seq(0, 100, by = 25),
    expand = c(.01, .001)) + 
  coord_cartesian(clip = "off")
```

***

<details><summary>Session Info</summary>

```{r sessionInfo}
## DO NOT REMOVE!
## We store the settings of your computer and the current versions of the
## packages used to allow for reproducibility
Sys.time()
#git2r::repository() ## uncomment if you are using GitHub
sessionInfo()
```

</details>
